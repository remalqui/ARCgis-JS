{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/mixins/EditBusLayer.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Evented.js\";import{clone as d}from\"../../core/lang.js\";import{createResolver as s}from\"../../core/promiseUtils.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Error.js\";import\"../../core/has.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";const i=new t.EventEmitter;function l(e,t,d=!1){const r=s();return d=null==t||d,i.emit(\"apply-edits\",{serviceUrl:e,layerId:t,mayReceiveServiceEdits:d,result:r.promise}),r}const a=\"esri.layers.mixins.EditBusLayer\",o=Symbol(a);function n(e){return null!=e&&\"object\"==typeof e&&o in e}const c=t=>{var s;let l=class extends t{constructor(...e){super(...e),this[s]=!0,this.when().then((()=>{this.own([i.on(\"apply-edits\",(e=>{const{serviceUrl:t,layerId:s,mayReceiveServiceEdits:r,result:i}=e,l=t===this.url,a=null!=s&&null!=this.layerId&&s===this.layerId;if(!l||!a&&!r)return;const o=i.then((e=>{if(a&&(e.addedFeatures.length||e.updatedFeatures.length||e.deletedFeatures.length||e.addedAttachments.length||e.updatedAttachments.length||e.deletedAttachments.length))return this.emit(\"edits\",d(e)),e;const t=e.editedFeatures?.find((({layerId:e})=>e===this.layerId));if(t){const{adds:s,updates:r,deletes:i}=t.editedFeatures,l={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:s?s.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],deletedFeatures:i?i.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],updatedFeatures:r?r.map((({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],editedFeatures:d(e.editedFeatures),exceededTransferLimit:!1};return this.emit(\"edits\",l),l}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:d(e.editedFeatures),exceededTransferLimit:!1}}));this.emit(\"apply-edits\",{result:o})}))])}),(()=>{}))}};return s=o,l=e([r(a)],l),l};export{c as EditBusLayer,l as emitApplyEditsEvent,n as isEditBusLayer};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAI2Y,IAAM,IAAE,IAAI,EAAE;AAAa,SAAS,EAAEA,IAAE,GAAE,IAAE,OAAG;AAAC,QAAM,IAAE,EAAE;AAAE,SAAO,IAAE,QAAM,KAAG,GAAE,EAAE,KAAK,eAAc,EAAC,YAAWA,IAAE,SAAQ,GAAE,wBAAuB,GAAE,QAAO,EAAE,QAAO,CAAC,GAAE;AAAC;AAAC,IAAMC,KAAE;AAAR,IAA0C,IAAE,OAAOA,EAAC;AAAE,SAASC,GAAEF,IAAE;AAAC,SAAO,QAAMA,MAAG,YAAU,OAAOA,MAAG,KAAKA;AAAC;AAAC,IAAM,IAAE,OAAG;AAAC,MAAI;AAAE,MAAIG,KAAE,cAAc,EAAC;AAAA,IAAC,eAAeH,IAAE;AAAC,YAAM,GAAGA,EAAC,GAAE,KAAK,CAAC,IAAE,MAAG,KAAK,KAAK,EAAE,KAAM,MAAI;AAAC,aAAK,IAAI,CAAC,EAAE,GAAG,eAAe,CAAAA,OAAG;AAAC,gBAAK,EAAC,YAAWI,IAAE,SAAQC,IAAE,wBAAuB,GAAE,QAAOC,GAAC,IAAEN,IAAEG,KAAEC,OAAI,KAAK,KAAIH,KAAE,QAAMI,MAAG,QAAM,KAAK,WAASA,OAAI,KAAK;AAAQ,cAAG,CAACF,MAAG,CAACF,MAAG,CAAC;AAAE;AAAO,gBAAMM,KAAED,GAAE,KAAM,CAAAN,OAAG;AAJx9B;AAIy9B,gBAAGC,OAAID,GAAE,cAAc,UAAQA,GAAE,gBAAgB,UAAQA,GAAE,gBAAgB,UAAQA,GAAE,iBAAiB,UAAQA,GAAE,mBAAmB,UAAQA,GAAE,mBAAmB;AAAQ,qBAAO,KAAK,KAAK,SAAQ,EAAEA,EAAC,CAAC,GAAEA;AAAE,kBAAMI,MAAE,KAAAJ,GAAE,mBAAF,mBAAkB,KAAM,CAAC,EAAC,SAAQA,GAAC,MAAIA,OAAI,KAAK;AAAU,gBAAGI,IAAE;AAAC,oBAAK,EAAC,MAAKC,IAAE,SAAQG,IAAE,SAAQF,GAAC,IAAEF,GAAE,gBAAeD,KAAE,EAAC,OAAM,MAAK,kBAAiB,CAAC,GAAE,oBAAmB,CAAC,GAAE,oBAAmB,CAAC,GAAE,eAAcE,KAAEA,GAAE,IAAK,CAAC,EAAC,YAAWL,GAAC,OAAK,EAAC,UAAS,KAAK,iBAAeA,GAAE,KAAK,aAAa,GAAE,UAAS,KAAK,iBAAeA,GAAE,KAAK,aAAa,EAAC,EAAG,IAAE,CAAC,GAAE,iBAAgBM,KAAEA,GAAE,IAAK,CAAC,EAAC,YAAWN,GAAC,OAAK,EAAC,UAAS,KAAK,iBAAeA,GAAE,KAAK,aAAa,GAAE,UAAS,KAAK,iBAAeA,GAAE,KAAK,aAAa,EAAC,EAAG,IAAE,CAAC,GAAE,iBAAgBQ,KAAEA,GAAE,IAAK,CAAC,EAAC,SAAQ,EAAC,YAAWR,GAAC,EAAC,OAAK,EAAC,UAAS,KAAK,iBAAeA,GAAE,KAAK,aAAa,GAAE,UAAS,KAAK,iBAAeA,GAAE,KAAK,aAAa,EAAC,EAAG,IAAE,CAAC,GAAE,gBAAe,EAAEA,GAAE,cAAc,GAAE,uBAAsB,MAAE;AAAE,qBAAO,KAAK,KAAK,SAAQG,EAAC,GAAEA;AAAA,YAAC;AAAC,mBAAM,EAAC,OAAM,MAAK,kBAAiB,CAAC,GAAE,oBAAmB,CAAC,GAAE,oBAAmB,CAAC,GAAE,eAAc,CAAC,GAAE,iBAAgB,CAAC,GAAE,iBAAgB,CAAC,GAAE,gBAAe,EAAEH,GAAE,cAAc,GAAE,uBAAsB,MAAE;AAAA,UAAC,CAAE;AAAE,eAAK,KAAK,eAAc,EAAC,QAAOO,GAAC,CAAC;AAAA,QAAC,CAAE,CAAC,CAAC;AAAA,MAAC,GAAI,MAAI;AAAA,MAAC,CAAE;AAAA,IAAC;AAAA,EAAC;AAAE,SAAO,IAAE,GAAEJ,KAAE,EAAE,CAACF,GAAEA,EAAC,CAAC,GAAEE,EAAC,GAAEA;AAAC;",
  "names": ["e", "a", "n", "l", "t", "s", "i", "o", "r"]
}
