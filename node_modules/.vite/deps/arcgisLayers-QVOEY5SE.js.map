{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/support/arcgisLayers.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{getFilename as r,urlToObject as a}from\"../../core/urlUtils.js\";import{parse as t,parseNonStandardSublayerUrl as s}from\"./arcgisLayerUrl.js\";import{fetchFeatureService as l}from\"./fetchService.js\";import{sceneServiceLayerTypeToClassName as n}from\"./layerUtils.js\";import{layerLookupMap as o}from\"./lazyLayerLoader.js\";import{fetchArcGISServiceJSON as u}from\"../../support/requestPresets.js\";const c={FeatureLayer:!0,SceneLayer:!0};async function i(e){const r=e.properties?.customParameters,a=await p(e.url,r),t={...e.properties,url:e.url};if(!a.sublayerIds)return null!=a.layerOrTableId&&(t.layerId=a.layerOrTableId,t.sourceJSON=a.sourceJSON),new a.Constructor(t);const s=new(0,(await import(\"../GroupLayer.js\")).default)({title:a.parsedUrl.title});return m(s,a,t),s}function y(e,r){return e?e.find((e=>e.id===r)):null}function m(e,r,a){function t(e,t){const s={...a,layerId:e,sublayerTitleMode:\"service-name\"};return null!=t&&(s.sourceJSON=t),new r.Constructor(s)}r.sublayerIds.forEach((a=>{const s=t(a,y(r.sublayerInfos,a));e.add(s)})),r.tableIds.forEach((a=>{const s=t(a,y(r.tableInfos,a));e.tables.add(s)}))}async function p(r,a){let s=t(r);if(null==s&&(s=await d(r,a)),null==s)throw new e(\"arcgis-layers:url-mismatch\",\"The url '${url}' is not a valid arcgis resource\",{url:r});const{serverType:l,sublayer:o}=s;let i;const y={FeatureServer:\"FeatureLayer\",StreamServer:\"StreamLayer\",VectorTileServer:\"VectorTileLayer\"};switch(l){case\"MapServer\":if(null!=o)i=\"FeatureLayer\";else{i=await S(r,a)?\"TileLayer\":\"MapImageLayer\"}break;case\"ImageServer\":{const e=await u(r,{customParameters:a}),{tileInfo:t,cacheType:s}=e;i=t?\"LERC\"!==t?.format?.toUpperCase()||s&&\"elevation\"!==s.toLowerCase()?\"ImageryTileLayer\":\"ElevationLayer\":\"ImageryLayer\";break}case\"SceneServer\":{const e=await u(s.url.path,{customParameters:a});if(i=\"SceneLayer\",e){const r=e?.layers;if(\"Voxel\"===e?.layerType)i=\"VoxelLayer\";else if(r?.length){const e=r[0]?.layerType;null!=e&&null!=n[e]&&(i=n[e])}}break}default:i=y[l]}const m=\"FeatureServer\"===l,p={parsedUrl:s,Constructor:null,layerOrTableId:m?o:void 0,sublayerIds:null,tableIds:null};if(c[i]&&null==o){const e=await I(r,l,a);m&&(p.sublayerInfos=e.layerInfos,p.tableInfos=e.tableInfos);1!==e.layerIds.length+e.tableIds.length?(p.sublayerIds=e.layerIds,p.tableIds=e.tableIds):m&&(p.layerOrTableId=e.layerIds[0]??e.tableIds[0],p.sourceJSON=e.layerInfos?.[0]??e.tableInfos?.[0])}return p.Constructor=await b(i),p}async function d(e,t){const l=await u(e,{customParameters:t});let n=null,o=null;const c=l.type;if(\"Feature Layer\"===c||\"Table\"===c?(n=\"FeatureServer\",o=l.id??null):\"indexedVector\"===c?n=\"VectorTileServer\":l.hasOwnProperty(\"mapName\")?n=\"MapServer\":l.hasOwnProperty(\"bandCount\")&&l.hasOwnProperty(\"pixelSizeX\")?n=\"ImageServer\":l.hasOwnProperty(\"maxRecordCount\")&&l.hasOwnProperty(\"allowGeometryUpdates\")?n=\"FeatureServer\":l.hasOwnProperty(\"streamUrls\")?n=\"StreamServer\":f(l)?(n=\"SceneServer\",o=l.id):l.hasOwnProperty(\"layers\")&&f(l.layers?.[0])&&(n=\"SceneServer\"),!n)return null;const i=null!=o?s(e):null;return{title:null!=i&&l.name||r(e),serverType:n,sublayer:o,url:{path:null!=i?i.serviceUrl:a(e).path}}}function f(e){return null!=e&&e.hasOwnProperty(\"store\")&&e.hasOwnProperty(\"id\")&&\"number\"==typeof e.id}async function I(e,r,a){let t,s=!1;if(\"FeatureServer\"===r){const r=await l(e,{customParameters:a});s=!!r.layersJSON,t=r.layersJSON||r.serviceJSON}else t=await u(e,{customParameters:a});const n=t?.layers,o=t?.tables;return{layerIds:n?.map((e=>e.id)).reverse()||[],tableIds:o?.map((e=>e.id)).reverse()||[],layerInfos:s?n:[],tableInfos:s?o:[]}}async function b(e){return(0,o[e])()}async function S(e,r){return(await u(e,{customParameters:r})).tileInfo}export{i as fromUrl};\n"],
  "mappings": "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",
  "names": ["c", "r", "a", "p", "t", "s", "e", "d", "i", "y", "m"]
}
