{
  "version": 3,
  "sources": ["../../@arcgis/core/renderers/support/heatmapUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../core/mathUtils.js\";import{px2pt as r,pt2px as n}from\"../../core/screenUtils.js\";import{l as o}from\"../../chunks/vec4.js\";import{c as e}from\"../../chunks/vec4f64.js\";const a=2.4;function i(t){return r(t*a)}function c(t){return n(t)/a}function f(r,n,e,a){let{color:i,ratio:c}=n,{color:f,ratio:u}=e;if(u===c){const t=1e-6;1===u?c-=t:u+=t}const s=t((a-c)/(u-c),0,1);o(r,i.toArray(),f.toArray(),s)}function u(t){const r=512,n=new Uint8ClampedArray(4*r);if(t=t.filter((({ratio:t})=>t>=0&&t<=1)).sort(((t,r)=>t.ratio-r.ratio)).map((({color:t,ratio:r})=>({color:t,ratio:Math.max(r,.001)}))),t.length<1)return n;let o=t[0],a=t[0],i=1;const c=e();for(let e=0;e<r;e++){const u=(e+.5)/r;for(;u>a.ratio&&i<t.length;)o=a,a=t[i++];f(c,o,a,u),n.set(c,4*e)}return n}function s(t,r,o,e){const{radius:a,fieldOffset:i,field:c}=r,f=Math.round(n(a)),u=new Float64Array(o*e);let s,l=Number.NEGATIVE_INFINITY;const h=d(c,i),y=new Set;for(const n of t){const t=n.getCursor();for(;t.next();){const r=t.getObjectId();if(y.has(r))continue;y.add(r);const n=t.readLegacyPointGeometry(),a=128;if(n.x<-a||n.x>=o+a||n.y<-a||n.y>e+a)continue;const i=+h(t),c=Math.max(0,Math.round(n.x)-f),d=Math.max(0,Math.round(n.y)-f),g=Math.min(e,Math.round(n.y)+f),A=Math.min(o,Math.round(n.x)+f);for(let t=d;t<g;t++)for(let r=c;r<A;r++){const e=t*o+r,a=m(n.x-r,n.y-t,f);s=u[e]+=a*i,s>l&&(l=s)}}}return{matrix:u.buffer,max:l}}function l(t,r,n,o,e,a){t.canvas.width=t.canvas.height=r,t.clearRect(0,0,r,r);const i=t.getImageData(0,0,r,r);n&&o&&i.data.set(new Uint8ClampedArray(h(r,n,o,e,a))),t.putImageData(i,0,0)}function h(r,n,o,e,a){const i=new Uint32Array(r*r),c=\"buffer\"in n?n:new Float64Array(n),f=\"buffer\"in o?new Uint32Array(o.buffer):new Uint32Array(new Uint8Array(o).buffer),u=f.length/(a-e);for(let s=0;s<c.length;s++){const r=c[s],n=Math.floor((r-e)*u);i[s]=f[t(n,0,f.length-1)]}return i.buffer}function m(t,r,n){const o=Math.sqrt(t**2+r**2)/n;return o>1?0:3/(Math.PI*n**2)*(1-o**2)**2}function y(t,r){return\"function\"==typeof t?t:t?\"string\"==typeof r?r=>-1*+r[t]:n=>+n[t]+r:()=>1}function d(t,r){return null!=t?\"string\"==typeof r?r=>-1*+r.readAttribute(t):n=>+n.readAttribute(t)+r:t=>1}export{a as MAGIC_KERNEL_DENSITY_RADIUS_INFLATION_FACTOR,s as calculateHeatmapIntensityInfoReaders,h as createHeatmapImageData,y as createValueFunction,d as createValueFunctionCursor,l as drawHeatmap,m as evaluateDensityKernel,i as gaussianBlurRadiusPxToKernelDensityRadiusPt,u as generateGradient,c as kernelDensityRadiusPtToGaussianBlurRadiusPx};\n"],
  "mappings": "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",
  "names": ["i", "n", "e", "a", "c", "f", "u", "s", "t", "r", "l", "h", "y", "d"]
}
