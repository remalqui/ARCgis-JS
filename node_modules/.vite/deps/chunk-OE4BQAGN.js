import {
  t
} from "./chunk-MW2UW5KK.js";
import {
  i
} from "./chunk-FLVP2XLK.js";
import {
  R,
  U,
  c,
  m,
  v,
  y
} from "./chunk-OO4A3EBQ.js";
import {
  n as n2
} from "./chunk-5EXFDBQJ.js";
import {
  d,
  n2 as n
} from "./chunk-OYBXMT5R.js";
import {
  o3 as o
} from "./chunk-CIDWM2UN.js";
import {
  Bt,
  V,
  Y,
  Z
} from "./chunk-O3CHVGVF.js";

// node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js
function g(t2) {
  const r = (t2 == null ? void 0 : t2.origins) ?? [void 0];
  return (e, o2) => {
    const s = h(t2, e, o2);
    for (const t3 of r) {
      const r2 = d(e, t3, o2);
      for (const t4 in s)
        r2[t4] = s[t4];
    }
  };
}
function h(t2, r, e) {
  if ("resource" === (t2 == null ? void 0 : t2.type))
    return v2(t2, r, e);
  switch ((t2 == null ? void 0 : t2.type) ?? "other") {
    case "other":
      return { read: true, write: true };
    case "url": {
      const { read: t3, write: r2 } = y;
      return { read: t3, write: r2 };
    }
  }
}
function v2(o2, s, n3) {
  const p = o(s, n3);
  return { type: String, read: (t2, r, e) => {
    const o3 = m(t2, r, e);
    return p.type === String ? o3 : "function" == typeof p.type ? new p.type({ url: o3 }) : void 0;
  }, write: { writer(s2, i2, u, c2) {
    if (!c2 || !c2.resources)
      return "string" == typeof s2 ? void (i2[u] = c(s2, c2)) : void (i2[u] = s2.write({}, c2));
    const y2 = x(s2), d2 = c(y2, { ...c2, verifyItemRelativeUrls: c2 && c2.verifyItemRelativeUrls ? { writtenUrls: c2.verifyItemRelativeUrls.writtenUrls, rootPath: void 0 } : void 0 }, R.NO), g2 = p.type !== String && (!i(this) || c2 && c2.origin && this.originIdOf(n3) > n(c2.origin)), h2 = { object: this, propertyName: n3, value: s2, targetUrl: d2, dest: i2, targetPropertyName: u, context: c2, params: o2 };
    c2 && c2.portalItem && d2 && !Y(d2) ? g2 ? w(h2) : j(h2) : c2 && c2.portalItem && (null == d2 || null != v(d2) || Z(d2) || g2) ? U2(h2) : i2[u] = d2;
  } } };
}
function U2(t2) {
  const { targetUrl: r, params: s, value: i2, context: a, dest: p, targetPropertyName: c2 } = t2;
  if (!a.portalItem)
    return;
  const l = U(r), m2 = (l == null ? void 0 : l.filename) ?? n2(), f = (s == null ? void 0 : s.prefix) ?? (l == null ? void 0 : l.prefix), d2 = N(i2, r, a), g2 = V(f, m2), h2 = `${g2}.${t(d2)}`, v3 = a.portalItem.resourceFromPath(h2);
  Z(r) && a.resources && a.resources.pendingOperations.push(P(r).then((t3) => {
    v3.path = `${g2}.${t(t3)}`, p[c2] = v3.itemRelativeUrl;
  }).catch(() => {
  }));
  const U3 = (s == null ? void 0 : s.compress) ?? false;
  a.resources && I({ ...t2, resource: v3, content: d2, compress: U3, updates: a.resources.toAdd }), p[c2] = v3.itemRelativeUrl;
}
function w(t2) {
  const { context: r, targetUrl: e, params: o2, value: n3, dest: i2, targetPropertyName: a } = t2;
  if (!r.portalItem)
    return;
  const p = r.portalItem.resourceFromPath(e), c2 = N(n3, e, r), l = t(c2), m2 = Bt(p.path), f = (o2 == null ? void 0 : o2.compress) ?? false;
  l === m2 ? (r.resources && I({ ...t2, resource: p, content: c2, compress: f, updates: r.resources.toUpdate }), i2[a] = e) : U2(t2);
}
function j({ context: t2, targetUrl: r, dest: e, targetPropertyName: o2 }) {
  t2.portalItem && t2.resources && (t2.resources.toKeep.push({ resource: t2.portalItem.resourceFromPath(r), compress: false }), e[o2] = r);
}
function I({ object: t2, propertyName: r, updates: e, resource: o2, content: s, compress: n3 }) {
  e.push({ resource: o2, content: s, compress: n3, finish: (e2) => {
    O(t2, r, e2);
  } });
}
function N(t2, r, e) {
  return "string" == typeof t2 ? { url: r } : new Blob([JSON.stringify(t2.toJSON(e))], { type: "application/json" });
}
async function P(t2) {
  const r = (await import("./request-JOIDVEEA.js")).default, { data: e } = await r(t2, { responseType: "blob" });
  return e;
}
function x(t2) {
  return null == t2 ? null : "string" == typeof t2 ? t2 : t2.url;
}
function O(t2, r, e) {
  "string" == typeof t2[r] ? t2[r] = e.url : t2[r].url = e.url;
}

export {
  g
};
//# sourceMappingURL=chunk-OE4BQAGN.js.map
