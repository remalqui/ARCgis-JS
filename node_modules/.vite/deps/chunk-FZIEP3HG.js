import {
  T,
  e2 as e4
} from "./chunk-NE5U5H4D.js";
import {
  e as e2,
  n as n2,
  y as y2
} from "./chunk-Y7HVH6RU.js";
import {
  M
} from "./chunk-JSMUQBPG.js";
import {
  D
} from "./chunk-BCDDCNQ2.js";
import {
  e as e3
} from "./chunk-D5NSNTGJ.js";
import {
  n
} from "./chunk-WBSPL6CJ.js";
import {
  m,
  y3 as y
} from "./chunk-OYBXMT5R.js";
import {
  a2
} from "./chunk-CIDWM2UN.js";
import {
  e
} from "./chunk-PD5Q7TDW.js";
import {
  C
} from "./chunk-HNHXEGH2.js";
import {
  s2 as s
} from "./chunk-W2N7YT6I.js";
import {
  a
} from "./chunk-I5JT24BO.js";
import {
  has
} from "./chunk-I4U7MQNO.js";

// node_modules/@arcgis/core/layers/effects/EffectView.js
var l = -1;
var a3 = class extends m {
  constructor(t2) {
    super(t2), this._from = null, this._to = null, this._final = null, this._current = [], this._time = 0, this.duration = has("mapview-transitions-duration"), this.effects = [];
  }
  set effect(t2) {
    if (this._get("effect") !== (t2 = t2 || "")) {
      this._set("effect", t2);
      try {
        this._transitionTo(h(t2));
      } catch (e6) {
        this._transitionTo([]), s.getLogger(this).warn("Invalid Effect", { effect: t2, error: e6 });
      }
    }
  }
  get hasEffects() {
    return this.transitioning || !!this.effects.length;
  }
  set scale(t2) {
    this._updateForScale(t2);
  }
  get transitioning() {
    return null !== this._to;
  }
  canTransitionTo(t2) {
    try {
      return this.scale > 0 && u(this._current, h(t2), this.scale);
    } catch {
      return false;
    }
  }
  transitionStep(t2, e6) {
    this._applyTimeTransition(t2), this._updateForScale(e6);
  }
  endTransitions() {
    this._applyTimeTransition(this.duration);
  }
  _transitionTo(t2) {
    this.scale > 0 && u(this._current, t2, this.scale) ? (this._final = t2, this._to = a(t2), _(this._current, this._to, this.scale), this._from = a(this._current), this._time = 0) : (this._from = this._to = this._final = null, this._current = t2), this._set("effects", this._current[0] ? a(this._current[0].effects) : []);
  }
  _applyTimeTransition(t2) {
    if (!(this._to && this._from && this._current && this._final))
      return;
    this._time += t2;
    const e6 = Math.min(1, this._time / this.duration);
    for (let s4 = 0; s4 < this._current.length; s4++) {
      const t3 = this._current[s4], r = this._from[s4], i3 = this._to[s4];
      t3.scale = p(r.scale, i3.scale, e6);
      for (let s5 = 0; s5 < t3.effects.length; s5++) {
        const n4 = t3.effects[s5], c = r.effects[s5], o2 = i3.effects[s5];
        n4.interpolate(c, o2, e6);
      }
    }
    1 === e6 && (this._current = this._final, this._set("effects", this._current[0] ? a(this._current[0].effects) : []), this._from = this._to = this._final = null);
  }
  _updateForScale(t2) {
    if (this._set("scale", t2), 0 === this._current.length)
      return;
    const e6 = this._current, s4 = this._current.length - 1;
    let r, i3, n4 = 1;
    if (1 === e6.length || t2 >= e6[0].scale)
      i3 = r = e6[0].effects;
    else if (t2 <= e6[s4].scale)
      i3 = r = e6[s4].effects;
    else
      for (let c = 0; c < s4; c++) {
        const s5 = e6[c], o2 = e6[c + 1];
        if (s5.scale >= t2 && o2.scale <= t2) {
          n4 = (t2 - s5.scale) / (o2.scale - s5.scale), r = s5.effects, i3 = o2.effects;
          break;
        }
      }
    for (let c = 0; c < this.effects.length; c++) {
      this.effects[c].interpolate(r[c], i3[c], n4);
    }
  }
};
function h(t2) {
  const e6 = y2(t2) || [];
  return m2(e6) ? [{ scale: l, effects: e6 }] : e6;
}
function u(t2, e6, s4) {
  var _a, _b, _c, _d;
  if (!((_a = t2[0]) == null ? void 0 : _a.effects) || !((_b = e6[0]) == null ? void 0 : _b.effects))
    return true;
  return !((((_c = t2[0]) == null ? void 0 : _c.scale) === l || ((_d = e6[0]) == null ? void 0 : _d.scale) === l) && (t2.length > 1 || e6.length > 1) && s4 <= 0) && n2(t2[0].effects, e6[0].effects);
}
function _(t2, e6, s4) {
  const r = t2.length > e6.length ? t2 : e6, i3 = t2.length > e6.length ? e6 : t2, n4 = i3[i3.length - 1], c = (n4 == null ? void 0 : n4.scale) ?? s4, o2 = (n4 == null ? void 0 : n4.effects) ?? [];
  for (let f = i3.length; f < r.length; f++)
    i3.push({ scale: c, effects: [...o2] });
  for (let a5 = 0; a5 < r.length; a5++)
    i3[a5].scale = i3[a5].scale === l ? s4 : i3[a5].scale, r[a5].scale = r[a5].scale === l ? s4 : r[a5].scale, e2(i3[a5].effects, r[a5].effects);
}
function p(t2, e6, s4) {
  return t2 + (e6 - t2) * s4;
}
function m2(t2) {
  const e6 = t2[0];
  return !!e6 && "type" in e6;
}
e([y()], a3.prototype, "_to", void 0), e([y()], a3.prototype, "duration", void 0), e([y({ value: "" })], a3.prototype, "effect", null), e([y({ readOnly: true })], a3.prototype, "effects", void 0), e([y({ readOnly: true })], a3.prototype, "hasEffects", null), e([y({ value: 0 })], a3.prototype, "scale", null), e([y({ readOnly: true })], a3.prototype, "transitioning", null), a3 = e([a2("esri.layers.effects.EffectView")], a3);

// node_modules/@arcgis/core/views/2d/engine/DisplayObject.js
var s2 = 1 / has("mapview-transitions-duration");
var i = class extends n {
  constructor() {
    super(...arguments), this._fadeOutResolver = null, this._fadeInResolver = null, this._clips = null, this.computedVisible = true, this.computedOpacity = 1, this.fadeTransitionEnabled = false, this.inFadeTransition = false, this._isReady = false, this._opacity = 1, this.parent = null, this._stage = null, this._visible = true;
  }
  get clips() {
    return this._clips;
  }
  set clips(e6) {
    this._clips = e6, this.requestRender();
  }
  get isReady() {
    return this._isReady;
  }
  get opacity() {
    return this._opacity;
  }
  set opacity(e6) {
    this._opacity !== e6 && (this._opacity = Math.min(1, Math.max(e6, 0)), this.requestRender());
  }
  get stage() {
    return this._stage;
  }
  set stage(e6) {
    var _a;
    if (this._stage === e6)
      return;
    const t2 = this._stage;
    this._stage = e6, e6 ? ((_a = this._stage) == null ? void 0 : _a.untrashDisplayObject(this)) || (this.onAttach(), this.emit("attach")) : t2 == null ? void 0 : t2.trashDisplayObject(this);
  }
  get transforms() {
    return this._getTransforms();
  }
  _getTransforms() {
    return null == this._transforms && (this._transforms = this._createTransforms()), this._transforms;
  }
  get visible() {
    return this._visible;
  }
  set visible(e6) {
    this._visible !== e6 && (this._visible = e6, this.requestRender());
  }
  fadeIn() {
    return this._fadeInResolver || (this._fadeOutResolver && (this._fadeOutResolver(), this._fadeOutResolver = null), this.opacity = 1, this.computedOpacity = 0, this.fadeTransitionEnabled = true, this._fadeInResolver = C(), this.requestRender()), this._fadeInResolver.promise;
  }
  fadeOut() {
    return this._fadeOutResolver || (this.opacity = 0, this._fadeInResolver && (this._fadeInResolver(), this._fadeInResolver = null), this.fadeTransitionEnabled = true, this._fadeOutResolver = C(), this.requestRender()), this._fadeOutResolver.promise;
  }
  endTransitions() {
    var _a, _b;
    (_a = this._fadeInResolver) == null ? void 0 : _a.call(this), this._fadeInResolver = null, (_b = this._fadeOutResolver) == null ? void 0 : _b.call(this), this._fadeOutResolver = null, this.computedOpacity = this.visible ? this.opacity : 0, this.requestRender();
  }
  beforeRender(e6) {
    this.updateTransitionProperties(e6.deltaTime, e6.state.scale);
  }
  afterRender(e6) {
    this._fadeInResolver && this.computedOpacity === this.opacity ? (this._fadeInResolver(), this._fadeInResolver = null) : this._fadeOutResolver && 0 === this.computedOpacity && (this._fadeOutResolver(), this._fadeOutResolver = null);
  }
  remove() {
    var _a;
    (_a = this.parent) == null ? void 0 : _a.removeChild(this);
  }
  setTransform(e6) {
  }
  processRender(e6) {
    this.stage && this.computedVisible && this.doRender(e6);
  }
  requestRender() {
    this.stage && this.stage.requestRender();
  }
  processDetach() {
    this._fadeInResolver && (this._fadeInResolver(), this._fadeInResolver = null), this._fadeOutResolver && (this._fadeOutResolver(), this._fadeOutResolver = null), this.onDetach(), this.emit("detach");
  }
  updateTransitionProperties(e6, t2) {
    if (this.fadeTransitionEnabled) {
      const t3 = this._fadeOutResolver || !this.visible ? 0 : this.opacity, i3 = this.computedOpacity;
      if (i3 === t3)
        this.computedVisible = this.visible;
      else {
        const r = e6 * s2;
        this.computedOpacity = i3 > t3 ? Math.max(t3, i3 - r) : Math.min(t3, i3 + r), this.computedVisible = this.computedOpacity > 0;
        const a5 = t3 === this.computedOpacity;
        this.inFadeTransition = !a5, a5 || this.requestRender();
      }
    } else
      this.computedOpacity = this.opacity, this.computedVisible = this.visible;
  }
  onAttach() {
  }
  onDetach() {
  }
  doRender(e6) {
  }
  ready() {
    this._isReady || (this._isReady = true, this.emit("isReady"), this.requestRender());
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/effects/highlight/parameters.js
var o = 1;
var t = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1];
var i2 = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];
var n3 = 256;
var e5 = { outlineWidth: 1.3, outerHaloWidth: 0.4, innerHaloWidth: 0.4, outlinePosition: 0 };

// node_modules/@arcgis/core/views/2d/engine/webgl/effects/highlight/HighlightGradient.js
var s3 = s.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");
function a4(o2, i3) {
  i3.fillColor[0] = o2.color.r / 255, i3.fillColor[1] = o2.color.g / 255, i3.fillColor[2] = o2.color.b / 255, i3.fillColor[3] = o2.color.a, o2.haloColor ? (i3.outlineColor[0] = o2.haloColor.r / 255, i3.outlineColor[1] = o2.haloColor.g / 255, i3.outlineColor[2] = o2.haloColor.b / 255, i3.outlineColor[3] = o2.haloColor.a) : (i3.outlineColor[0] = i3.fillColor[0], i3.outlineColor[1] = i3.fillColor[1], i3.outlineColor[2] = i3.fillColor[2], i3.outlineColor[3] = i3.fillColor[3]), i3.fillColor[3] *= o2.fillOpacity, i3.outlineColor[3] *= o2.haloOpacity, i3.fillColor[0] *= i3.fillColor[3], i3.fillColor[1] *= i3.fillColor[3], i3.fillColor[2] *= i3.fillColor[3], i3.outlineColor[0] *= i3.outlineColor[3], i3.outlineColor[1] *= i3.outlineColor[3], i3.outlineColor[2] *= i3.outlineColor[3], i3.outlineWidth = e5.outlineWidth, i3.outerHaloWidth = e5.outerHaloWidth, i3.innerHaloWidth = e5.innerHaloWidth, i3.outlinePosition = e5.outlinePosition;
}
var u2 = [0, 0, 0, 0];
var d = class {
  constructor() {
    this._convertedHighlightOptions = { fillColor: [0.2 * 0.75, 0.6 * 0.75, 0.675, 0.75], outlineColor: [0.2 * 0.9, 0.54, 0.81, 0.9], outlinePosition: e5.outlinePosition, outlineWidth: e5.outlineWidth, innerHaloWidth: e5.innerHaloWidth, outerHaloWidth: e5.outerHaloWidth }, this._shadeTexChanged = true, this._texelData = new Uint8Array(4 * n3), this._minMaxDistance = [0, 0];
  }
  setHighlightOptions(o2) {
    const i3 = this._convertedHighlightOptions;
    a4(o2, i3);
    const t2 = i3.outlinePosition - i3.outlineWidth / 2 - i3.outerHaloWidth, r = i3.outlinePosition - i3.outlineWidth / 2, n4 = i3.outlinePosition + i3.outlineWidth / 2, h3 = i3.outlinePosition + i3.outlineWidth / 2 + i3.innerHaloWidth, d2 = Math.sqrt(Math.PI / 2) * o, C2 = Math.abs(t2) > d2 ? Math.round(10 * (Math.abs(t2) - d2)) / 10 : 0, f = Math.abs(h3) > d2 ? Math.round(10 * (Math.abs(h3) - d2)) / 10 : 0;
    let g;
    C2 && !f ? s3.error("The outer rim of the highlight is " + C2 + "px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards).") : !C2 && f ? s3.error("The inner rim of the highlight is " + f + "px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards).") : C2 && f && s3.error("The highlight is " + Math.max(C2, f) + "px away from the edge of the feature; consider reducing some width values.");
    const c = [void 0, void 0, void 0, void 0];
    function m3(o3, i4, t3) {
      c[0] = (1 - t3) * o3[0] + t3 * i4[0], c[1] = (1 - t3) * o3[1] + t3 * i4[1], c[2] = (1 - t3) * o3[2] + t3 * i4[2], c[3] = (1 - t3) * o3[3] + t3 * i4[3];
    }
    const { _texelData: p2 } = this;
    for (let l2 = 0; l2 < n3; ++l2)
      g = t2 + l2 / (n3 - 1) * (h3 - t2), g < t2 ? (c[4 * l2] = 0, c[4 * l2 + 1] = 0, c[4 * l2 + 2] = 0, c[4 * l2 + 3] = 0) : g < r ? m3(u2, i3.outlineColor, (g - t2) / (r - t2)) : g < n4 ? [c[0], c[1], c[2], c[3]] = i3.outlineColor : g < h3 ? m3(i3.outlineColor, i3.fillColor, (g - n4) / (h3 - n4)) : [c[4 * l2], c[4 * l2 + 1], c[4 * l2 + 2], c[4 * l2 + 3]] = i3.fillColor, p2[4 * l2] = 255 * c[0], p2[4 * l2 + 1] = 255 * c[1], p2[4 * l2 + 2] = 255 * c[2], p2[4 * l2 + 3] = 255 * c[3];
    this._minMaxDistance[0] = t2, this._minMaxDistance[1] = h3, this._shadeTexChanged = true;
  }
  applyHighlightOptions(o2, t2) {
    if (!this._shadeTex) {
      const i3 = new e4();
      i3.wrapMode = D.CLAMP_TO_EDGE, i3.width = n3, i3.height = 1, this._shadeTex = new T(o2, i3);
    }
    this._shadeTexChanged && (this._shadeTex.updateData(0, 0, 0, n3, 1, this._texelData), this._shadeTexChanged = false), o2.bindTexture(this._shadeTex, M), t2.setUniform2fv("u_minMaxDistance", this._minMaxDistance);
  }
  destroy() {
    var _a;
    (_a = this._shadeTex) == null ? void 0 : _a.dispose(), this._shadeTex = null;
  }
};

// node_modules/@arcgis/core/views/2d/engine/Container.js
var h2 = class extends i {
  constructor() {
    super(...arguments), this._childrenSet = /* @__PURE__ */ new Set(), this._needsSort = false, this.children = [], this._effectView = null, this._highlightOptions = null, this._highlightGradient = null;
  }
  get blendMode() {
    return this._blendMode;
  }
  set blendMode(e6) {
    this._blendMode = e6, this.requestRender();
  }
  get clips() {
    return this._clips;
  }
  set clips(e6) {
    this._clips = e6, this.children.forEach((t2) => t2.clips = e6);
  }
  get computedEffects() {
    var _a;
    return ((_a = this._effectView) == null ? void 0 : _a.effects) ?? null;
  }
  get effect() {
    var _a;
    return ((_a = this._effectView) == null ? void 0 : _a.effect) ?? "";
  }
  set effect(e6) {
    (this._effectView || e6) && (this._effectView || (this._effectView = new a3()), this._effectView.effect = e6, this.requestRender());
  }
  get highlightOptions() {
    return this._highlightOptions;
  }
  set highlightOptions(e6) {
    if (!e6)
      return this._highlightOptions = null, void (this._highlightGradient && (this._highlightGradient.destroy(), this._highlightGradient = null, this.requestRender()));
    this._highlightOptions && this._highlightOptions.equals(e6) || (this._highlightOptions = e6, this._highlightGradient || (this._highlightGradient = new d()), this._highlightGradient.setHighlightOptions(e6), this.requestRender());
  }
  updateTransitionProperties(e6, t2) {
    super.updateTransitionProperties(e6, t2), this._effectView && (this._effectView.transitionStep(e6, t2), this._effectView.transitioning && this.requestRender());
  }
  doRender(e6) {
    const t2 = this.createRenderParams(e6);
    this.renderChildren(t2);
  }
  addChild(e6) {
    return this.addChildAt(e6, this.children.length);
  }
  addChildAt(e6, t2 = this.children.length) {
    if (!e6)
      return e6;
    if (this.contains(e6))
      return e6;
    this._needsSort = true;
    const i3 = e6.parent;
    return i3 && i3 !== this && i3.removeChild(e6), t2 >= this.children.length ? this.children.push(e6) : this.children.splice(t2, 0, e6), this._childrenSet.add(e6), e6.parent = this, e6.stage = this.stage, this !== this.stage && (e6.clips = this.clips), this.requestRender(), e6;
  }
  contains(e6) {
    return this._childrenSet.has(e6);
  }
  endTransitions() {
    super.endTransitions(), this._effectView && (this._effectView.endTransitions(), this.requestRender());
  }
  removeAllChildren() {
    this._childrenSet.clear(), this._needsSort = true;
    for (const e6 of this.children)
      this !== this.stage && (e6.clips = null), e6.stage = null, e6.parent = null;
    this.children.length = 0;
  }
  removeChild(e6) {
    return this.contains(e6) ? this.removeChildAt(this.children.indexOf(e6)) : e6;
  }
  removeChildAt(e6) {
    if (e6 < 0 || e6 >= this.children.length)
      return null;
    this._needsSort = true;
    const t2 = this.children.splice(e6, 1)[0];
    return this._childrenSet.delete(t2), this !== this.stage && (t2.clips = null), t2.stage = null, t2.parent = null, t2;
  }
  sortChildren(e6) {
    this._needsSort && (this.children.sort(e6), this._needsSort = false);
  }
  beforeRender(e6) {
    super.beforeRender(e6);
    for (const t2 of this.children)
      t2.beforeRender(e6);
  }
  afterRender(e6) {
    super.afterRender(e6);
    for (const t2 of this.children)
      t2.afterRender(e6);
  }
  _createTransforms() {
    return { dvs: e3() };
  }
  onAttach() {
    super.onAttach();
    const e6 = this.stage;
    for (const t2 of this.children)
      t2.stage = e6;
  }
  onDetach() {
    super.onDetach();
    for (const e6 of this.children)
      e6.stage = null;
  }
  renderChildren(e6) {
    for (const t2 of this.children)
      t2.processRender(e6);
  }
  createRenderParams(e6) {
    return { ...e6, blendMode: this.blendMode, effects: this.computedEffects, globalOpacity: e6.globalOpacity * this.computedOpacity, inFadeTransition: this.inFadeTransition, highlightGradient: this._highlightGradient || e6.highlightGradient };
  }
};

export {
  a3 as a,
  i,
  o,
  t,
  i2,
  h2 as h
};
//# sourceMappingURL=chunk-FZIEP3HG.js.map
