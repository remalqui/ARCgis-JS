{
  "version": 3,
  "sources": ["../../@arcgis/core/views/layers/StreamLayerView.js", "../../@arcgis/core/views/2d/layers/StreamLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../../chunks/tslib.es6.js\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import t from\"../../layers/support/FeatureFilter.js\";const o=o=>{let i=class extends o{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return this._isUserPaused?\"paused\":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return s([e()],i.prototype,\"_isUserPaused\",void 0),s([e({readOnly:!0})],i.prototype,\"connectionStatus\",null),s([e({type:t})],i.prototype,\"filter\",void 0),i=s([r(\"esri.layers.mixins.StreamLayerView\")],i),i};export{o as default};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{handlesGroup as r}from\"../../../core/handleUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../rest/support/FeatureSet.js\";import a from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as l}from\"./support/util.js\";import p from\"../../layers/StreamLayerView.js\";function c(e,t){if(null==e&&null==t)return null;const r={};return null!=t&&(r.geometry=t.toJSON()),null!=e&&(r.where=e),r}let u=class extends(p(a)){constructor(){super(...arguments),this.pipelineConnectionStatus=\"disconnected\",this.pipelineErrorString=null,this._enabledEventTypes=new Set}initialize(){this.addHandles([s((()=>this.layer.customParameters),(e=>this._proxy.updateCustomParameters(e))),this.layer.on(\"send-message-to-socket\",(e=>this._proxy.sendMessageToSocket(e))),this.layer.on(\"send-message-to-client\",(e=>this._proxy.sendMessageToClient(e))),s((()=>this.layer.purgeOptions),(()=>this._update())),s((()=>this.suspended),this._onSuspendedChange.bind(this))],\"constructor\")}get connectionError(){return this.pipelineErrorString?new t(\"stream-controller\",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return r(e.map((e=>this.on(e,t))));const s=[\"data-received\",\"message-received\"].includes(e);s&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));const i=super.on(e,t),o=this;return{remove(){i.remove(),s&&(o._proxy.closed||o.hasEventListener(e)||o._proxy.enableEvent(e,!1))}}}queryLatestObservations(e,r){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=n.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.pipelineConnectionStatus=\"disconnected\"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._proxy?.pauseStream()}_doResume(){this._proxy?.resumeStream()}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(c(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=l(e.geometryType),i=e.timeInfo&&e.timeInfo.toJSON()||null,o=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",isPaused:this._isUserPaused,fields:r,geometryType:s,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:c(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:o,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([i()],u.prototype,\"pipelineConnectionStatus\",void 0),e([i()],u.prototype,\"pipelineErrorString\",void 0),e([i({readOnly:!0})],u.prototype,\"connectionError\",null),e([i({readOnly:!0})],u.prototype,\"_streamConnectionStatus\",null),u=e([o(\"esri.views.2d.layers.StreamLayerView2D\")],u);const y=u;export{y as default};\n"],
  "mappings": "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",
  "names": ["o", "s", "d", "e", "s", "o", "y"]
}
