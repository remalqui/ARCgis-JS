import {
  a as a3,
  c
} from "./chunk-YM46NRFF.js";
import {
  v
} from "./chunk-62M25QKF.js";
import {
  C
} from "./chunk-TNXVIMSN.js";
import {
  o as o5,
  p,
  p2
} from "./chunk-E4GDJ764.js";
import {
  m,
  p as p3
} from "./chunk-HZHMZHPT.js";
import {
  k
} from "./chunk-QA4FMJA6.js";
import {
  D
} from "./chunk-VFQINJTY.js";
import {
  o as o3
} from "./chunk-EIE3W25Z.js";
import {
  o as o4
} from "./chunk-4H5JODOT.js";
import {
  o2,
  r
} from "./chunk-SFV6XLDZ.js";
import {
  l
} from "./chunk-7A5C2EQ3.js";
import {
  y3 as y
} from "./chunk-OYBXMT5R.js";
import {
  a2
} from "./chunk-CIDWM2UN.js";
import {
  e
} from "./chunk-PD5Q7TDW.js";
import {
  a,
  o
} from "./chunk-I5JT24BO.js";

// node_modules/@arcgis/core/layers/support/FeatureReduction.js
var t = class extends l {
  constructor() {
    super(...arguments), this.type = null;
  }
};
e([y({ type: ["selection", "cluster", "binning"], readOnly: true, json: { read: false, write: true } })], t.prototype, "type", void 0), t = e([a2("esri.layers.support.FeatureReduction")], t);

// node_modules/@arcgis/core/layers/support/FeatureReductionSelection.js
var t2;
var c2 = t2 = class extends t {
  constructor(r3) {
    super(r3), this.type = "selection";
  }
  clone() {
    return new t2();
  }
};
e([y({ type: ["selection"] })], c2.prototype, "type", void 0), c2 = t2 = e([a2("esri.layers.support.FeatureReductionSelection")], c2);
var p4 = c2;

// node_modules/@arcgis/core/layers/support/FeatureReductionBinning.js
var b;
var g = "esri.layers.support.FeatureReductionBinning";
var h = b = class extends t {
  constructor(e2) {
    super(e2), this.type = "binning", this.binType = "geohash", this.fixedBinLevel = 3, this.labelingInfo = null, this.labelsVisible = true, this.maxScale = 0, this.popupEnabled = true, this.popupTemplate = null, this.fields = [], this.renderer = null;
  }
  writeFields(e2, r3, o7) {
    const t3 = e2.filter((e3) => "avg_angle" !== e3.statisticType).map((e3) => e3.toJSON());
    o(o7, t3, r3);
  }
  readRenderer(e2, r3, t3) {
    var _a;
    const s = (_a = r3.drawingInfo) == null ? void 0 : _a.renderer;
    return s ? o5(s, r3, t3) ?? void 0 : v(r3, t3);
  }
  clone() {
    return new b({ fields: a(this.fields), fixedBinLevel: this.fixedBinLevel, labelingInfo: a(this.labelingInfo), labelsVisible: this.labelsVisible, maxScale: this.maxScale, popupEnabled: this.popupEnabled, popupTemplate: a(this.popupTemplate), renderer: a(this.renderer) });
  }
};
e([o4({ binning: "binning" })], h.prototype, "type", void 0), e([o4({ geohash: "geohash" })], h.prototype, "binType", void 0), e([y({ type: Number, range: { min: 1, max: 9 }, json: { write: true } })], h.prototype, "fixedBinLevel", void 0), e([y({ type: [C], json: { read: { source: "drawingInfo.labelingInfo" }, write: { target: "drawingInfo.labelingInfo" } } })], h.prototype, "labelingInfo", void 0), e([y(m)], h.prototype, "labelsVisible", void 0), e([y({ type: Number, json: { default: 0, name: "visibilityInfo.maxScale" } })], h.prototype, "maxScale", void 0), e([y(p3)], h.prototype, "popupEnabled", void 0), e([y({ type: k, json: { name: "popupInfo", write: true } })], h.prototype, "popupTemplate", void 0), e([y({ type: [a3], json: { write: true } })], h.prototype, "fields", void 0), e([r("fields")], h.prototype, "writeFields", null), e([y({ types: p2, json: { write: { target: "drawingInfo.renderer" } } })], h.prototype, "renderer", void 0), e([o2("renderer", ["drawingInfo.renderer"])], h.prototype, "readRenderer", null), h = b = e([a2(g)], h);
var v2 = h;

// node_modules/@arcgis/core/layers/support/FeatureReductionCluster.js
var g2;
var S = "esri.layers.support.FeatureReductionCluster";
function w(e2) {
  var _a;
  return "simple" === e2.type && !((_a = e2.visualVariables) == null ? void 0 : _a.length);
}
var I = g2 = class extends l {
  constructor(e2) {
    super(e2), this.type = "cluster", this.clusterRadius = o3("80px"), this.clusterMinSize = o3("12px"), this.clusterMaxSize = o3("50px"), this.maxScale = 0, this.popupEnabled = true, this.popupTemplate = null, this.renderer = null, this.symbol = null, this.labelingInfo = null, this.labelsVisible = true, this.fields = null;
  }
  readRenderer(e2, r3, t3) {
    var _a, _b;
    const s = (_a = r3.drawingInfo) == null ? void 0 : _a.renderer;
    return ((_b = s == null ? void 0 : s.authoringInfo) == null ? void 0 : _b.isAutoGenerated) ? null : s ? w(s) ? null : o5(s, r3, t3) ?? void 0 : v(r3, t3);
  }
  readSymbol(e2, r3, t3) {
    var _a, _b;
    const s = (_a = r3.drawingInfo) == null ? void 0 : _a.renderer;
    if ((_b = s == null ? void 0 : s.authoringInfo) == null ? void 0 : _b.isAutoGenerated)
      return null;
    if (s && w(s)) {
      const e3 = o5(s, r3, t3);
      return e3 == null ? void 0 : e3.symbol;
    }
    return null;
  }
  writeSymbol(e2, r3, o7, s) {
    var _a, _b;
    const i = (_b = (_a = this.renderer) == null ? void 0 : _a.authoringInfo) == null ? void 0 : _b.isAutoGenerated;
    if (!this.renderer || i) {
      const o8 = new p({ symbol: e2 });
      r3.drawingInfo = { renderer: o8.write({}, s) };
    }
  }
  writeFields(e2, r3, t3) {
    const o7 = e2.filter((e3) => "avg_angle" !== e3.statisticType).map((e3) => e3.toJSON());
    o(t3, o7, r3);
  }
  readFields(e2, r3, t3) {
    return e2.filter((e3) => !e3.isAutoGenerated).map((e3) => a3.fromJSON(e3));
  }
  clone() {
    return new g2({ clusterRadius: this.clusterRadius, clusterMinSize: this.clusterMinSize, clusterMaxSize: this.clusterMaxSize, labelingInfo: a(this.labelingInfo), labelsVisible: this.labelsVisible, fields: a(this.fields), maxScale: this.maxScale, renderer: a(this.renderer), symbol: a(this.symbol), popupEnabled: this.popupEnabled, popupTemplate: a(this.popupTemplate) });
  }
};
e([y({ type: ["cluster"], readOnly: true, json: { write: true } })], I.prototype, "type", void 0), e([y({ type: Number, cast: (e2) => "auto" === e2 ? e2 : o3(e2), json: { write: true } })], I.prototype, "clusterRadius", void 0), e([y({ type: Number, cast: o3, json: { write: true } })], I.prototype, "clusterMinSize", void 0), e([y({ type: Number, cast: o3, json: { write: true } })], I.prototype, "clusterMaxSize", void 0), e([y({ type: Number, json: { default: 0, name: "visibilityInfo.maxScale" } })], I.prototype, "maxScale", void 0), e([y(p3)], I.prototype, "popupEnabled", void 0), e([y({ type: k, json: { read: { source: "popupInfo" }, write: { target: "popupInfo" } } })], I.prototype, "popupTemplate", void 0), e([y({ types: p2, json: { write: { target: "drawingInfo.renderer" } } })], I.prototype, "renderer", void 0), e([o2("renderer", ["drawingInfo.renderer"])], I.prototype, "readRenderer", null), e([y({ types: D })], I.prototype, "symbol", void 0), e([o2("symbol", ["drawingInfo.renderer"])], I.prototype, "readSymbol", null), e([r("symbol")], I.prototype, "writeSymbol", null), e([y({ type: [C], json: { read: { source: "drawingInfo.labelingInfo" }, write: { target: "drawingInfo.labelingInfo" } } })], I.prototype, "labelingInfo", void 0), e([y(m)], I.prototype, "labelsVisible", void 0), e([y({ type: [a3], json: { write: true } })], I.prototype, "fields", void 0), e([r("fields")], I.prototype, "writeFields", null), e([o2("fields")], I.prototype, "readFields", null), I = g2 = e([a2(S)], I);
var v3 = I;

// node_modules/@arcgis/core/layers/support/featureReductionUtils.js
var o6 = { key: "type", base: t, typeMap: { cluster: v3, binning: v2 } };
var r2 = { types: { key: "type", base: t, typeMap: { selection: p4, cluster: v3, binning: v2 } }, json: { name: "layerDefinition.featureReduction", write: { allowNull: true }, origins: { "web-map": { types: o6 }, "portal-item": { types: o6 }, "web-scene": { types: { key: "type", base: t, typeMap: { selection: p4 } } } } } };

// node_modules/@arcgis/core/layers/mixins/FeatureReductionLayer.js
var n = (n2) => {
  let u = class extends n2 {
    constructor(...e2) {
      super(...e2), this.own(this.watch("renderer", () => {
        if (this.featureReduction) {
          const e3 = this._normalizeFeatureReduction(this.featureReduction);
          this._set("featureReduction", e3);
        }
      }, true));
    }
    set featureReduction(e2) {
      const r3 = this._normalizeFeatureReduction(e2);
      this._set("featureReduction", r3);
    }
    set renderer(e2) {
    }
    _normalizeFeatureReduction(e2) {
      var _a;
      if ("cluster" !== (e2 == null ? void 0 : e2.type))
        return e2;
      const r3 = e2.clone(), t3 = [new a3({ name: "cluster_count", isAutoGenerated: true, statisticType: "count" })], o7 = (r3.fields ?? []).filter((e3) => !e3.isAutoGenerated);
      if (e2.renderer && !((_a = e2.renderer.authoringInfo) == null ? void 0 : _a.isAutoGenerated))
        return r3.fields = [...t3, ...o7], r3;
      if (e2.symbol)
        return r3.fields = [...t3, ...o7], r3.renderer = null, r3;
      if (!this.renderer)
        return e2;
      const n3 = c(t3, this.renderer, e2, null, false);
      return r3.fields = [...t3, ...o7], r3.renderer = n3, r3;
    }
  };
  return e([y(r2)], u.prototype, "featureReduction", null), u = e([a2("esri.layers.mixins.FeatureReductionLayer")], u), u;
};

export {
  t,
  p4 as p,
  n
};
//# sourceMappingURL=chunk-UMKNA5PR.js.map
