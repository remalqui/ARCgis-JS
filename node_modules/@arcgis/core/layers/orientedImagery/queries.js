/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import"../../geometry.js";import e from"../OrientedImageryLayer.js";import r from"./core/ExposurePoint.js";import t from"../../rest/support/Query.js";import a from"../../geometry/Extent.js";const n={},o=1e3;async function s(r,a){const{point:s,queryParams:y,queryFeatures:u}=r,c={};let l=r.layerInstanceOrURL;if(y&&(c.maxRecordCountFactor=y.maxRecordCountFactor??5,c.outFields=y.outFields??["*"],c.where=y.where??"1=1",c.returnGeometry=y.returnGeometry??!0),"string"==typeof l&&(n.layer&&n.layer.url===l?l=n.layer:(n.layer?.destroy(),l=n.layer=new e({url:l}),await l.load())),l){if(u&&"esri.layers.OrientedImageryLayer"===l?.declaredClass)return m(l)(u);const e=l,r=i(s,y?.maximumDistance??e.maximumDistance??o),n=new t({geometry:r,...c});return e.queryFeatures(n,a).then(m(e))}return null}function m(e){return t=>{const{features:a,spatialReference:n}=t;return a.forEach((t=>{t.geometry&&(t.geometry.spatialReference=n);const a=r.fromJSON({...t.toJSON(),layer:e});a&&(t.attributes=a),t.layer=e,t.spatialReference=n})),t}}function i(e,r){const t=e.x-r,n=e.x+r,o=e.y-r,s=e.y+r;return new a({xmin:t,xmax:n,ymin:o,ymax:s,spatialReference:e.spatialReference})}export{i as createExtentFromPointAtDistance,s as searchImages};
