/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as t}from"../../../chunks/tslib.es6.js";import"../../../geometry.js";import{ClonableMixin as e}from"../../../core/Clonable.js";import r from"../../../core/Error.js";import{JSONSupport as a}from"../../../core/JSONSupport.js";import{property as o}from"../../../core/accessorSupport/decorators/property.js";import{cast as i}from"../../../core/accessorSupport/decorators/cast.js";import"../../../core/arrayUtils.js";import"../../../core/has.js";import{reader as n}from"../../../core/accessorSupport/decorators/reader.js";import{subclass as s}from"../../../core/accessorSupport/decorators/subclass.js";import p from"./cameraOrientationFactory.js";import{CameraOrientationType as u}from"../enums/CameraOrientationType.js";import c from"../../../geometry/Point.js";function m(t,e){switch(t){case"O":return e&&e<10?"nadir":"oblique";case"B":case"S":case"D":return"360";default:return"horizontal"}}function l(t){throw new r("exposure-point:missing-default-value",`a value for ${t} is missing in default properties`)}function d(t,e){throw new r("exposure-point:missing-attribute-value",`a value for ${t} is missing in attribute table`,{exposurePoint:e})}let y=class extends(e(a)){constructor(t){super(t),this.cameraOrientation=null,this.elevation=null,this.elevationSource=null,this.name=null}read(t,e){const r={},{attributes:a}=t;for(const o in a)r[o.toLowerCase()]=a[o];super.read({...t,attributes:r},e)}readCameraHeading(t,e){const{attributes:r,layer:a}=e;return r.cameraheading??r.camheading??a.cameraHeading}readCameraHeight(t,e){const{attributes:r,layer:a}=e;return r.cameraheight??r.avghtag??a.cameraHeight}readCamOffset(t,e){const{attributes:r}=e;return r.cameraoffset?.split(";").map(Number)??r.camoffset?.split(";").map(Number)??null}readCameraOrientation(t,e){const{attributes:r}=e;return r.cameraorientation??r.camori}readCameraPitch(t,e){const{attributes:r,layer:a}=e;return r.camerapitch??r.campitch??a.cameraPitch}readCameraRoll(t,e){const{attributes:r,layer:a}=e;return r.cameraroll??r.camroll??a.cameraRoll}readDepthImage(t,e){const{attributes:r,layer:a}=e;let o=r.depthimage??r.depthimg??null;if(!o)return null;const{depthImagePathPrefix:i,depthImagePathSuffix:n}=a,s=i?.trim();s&&(o=`${s}/${o}`);const p=n?.trim();return p&&(o=`${o}/${p}`),o}readElevationSource(t,e){const{attributes:r,layer:a}=e;if(r.elevationSource){const t=r.elevationSource;let{url:e}=t;if(e){const{demPathSuffix:r,demPathPrefix:o}=a;return o?.trim()&&(e=o?.trim()+"/"+e),r?.trim()&&(e=e+"/"+r?.trim()),{...t,url:e}}return t}if(r.dem){let t=r.dem.trim();if(t){const{demPathSuffix:r,demPathPrefix:a}=e.layer;return a?.trim()&&(t=a?.trim()+"/"+t),r?.trim()&&(t=t+"/"+r?.trim()),{url:t}}}return a.effectiveElevationSource}readFarDistance(t,e){const{attributes:r,layer:a}=e;return r.fardistance??r.fardist??a.farDistance}readHFOV(t,e){const{attributes:r,layer:a}=e;return r.horizontalfieldofview??r.hfov??a.horizontalFieldOfView}readImageURL(t,e){const{attributes:r,layer:a}=e,{image:o}=r;o||d("image",this);const{imagePathPrefix:i,imagePathSuffix:n}=a;let s=o;const p=i?.trim();p&&(s=`${p.trim()}/${s}`);const u=n?.trim();return u&&(s=`${s}/${u.trim()}`),s}readImageRotation(t,e){const{attributes:r,layer:a}=e;return r.imagerotation??r.imgrot??a.imageRotation}get isHorizontal(){return"horizontal"===this.orientedImageryType}get isInspection(){return"inspection"===this.orientedImageryType}get isNadir(){return"nadir"===this.orientedImageryType}get isOblique(){return"oblique"===this.orientedImageryType}get isSpherical(){return"360"===this.orientedImageryType}get location(){const{cameraOrientation:t,geometry:e,cameraHeight:r,elevation:a}=this;if(t){const{type:e,x:r,y:a,z:o,horizontalWKID:i}=t;return new c({x:r,y:a,z:o,spatialReference:{wkid:e===u.LTP?4326:i}})}if(!r)throw l("cameraHeight");return e.z=(a??0)+r,e}readName(t,e){const{attributes:r}=e;return r.name}readNearDistance(t,e){const{attributes:r,layer:a}=e;return r.neardistance??r.neardist??a.nearDistance}readOrientationAccuracy(t,e){return e.attributes.orientationaccuracy?.split(";").map(Number)??e.attributes.accuracy?.split(";").map(Number)??null}readOIType(t,e){const{attributes:r,layer:a}=e;if(r.orientedimagerytype)return r.orientedimagerytype.toLowerCase();if(r.oitype){const t=r.camerapitch??r.campitch??a.cameraPitch;return m(r.oitype.toUpperCase(),t)}return a.orientedImageryType}readSortOrder(t,e){return e.attributes.sortorder}readVFOV(t,e){const{attributes:r,layer:a}=e;return r.verticalfieldofview??r.vfov??a.verticalFieldOfView}};t([o({type:Date,json:{write:!0,name:"attributes.acquisitiondate"}})],y.prototype,"acquisitionDate",void 0),t([o({type:Number,json:{write:!0}})],y.prototype,"cameraHeading",void 0),t([n("cameraHeading",["attributes"])],y.prototype,"readCameraHeading",null),t([o({type:Number,json:{write:!0}})],y.prototype,"cameraHeight",void 0),t([n("cameraHeight",["attributes"])],y.prototype,"readCameraHeight",null),t([o({json:{write:!0}})],y.prototype,"cameraOffset",void 0),t([n("cameraOffset",["attributes"])],y.prototype,"readCamOffset",null),t([o({json:{write:!0}}),i((t=>t?p.getCameraOrientation(t):null))],y.prototype,"cameraOrientation",void 0),t([n("cameraOrientation",["attributes"])],y.prototype,"readCameraOrientation",null),t([o({type:Number,json:{write:!0}})],y.prototype,"cameraPitch",void 0),t([n("cameraPitch",["attributes"])],y.prototype,"readCameraPitch",null),t([o({type:Number,json:{write:!0}})],y.prototype,"cameraRoll",void 0),t([n("cameraRoll",["attributes"])],y.prototype,"readCameraRoll",null),t([o({json:{write:!0}})],y.prototype,"depthImage",void 0),t([n("depthImage",["attributes"])],y.prototype,"readDepthImage",null),t([o({type:Number,json:{write:!0}})],y.prototype,"elevation",void 0),t([o({json:{write:!0}})],y.prototype,"elevationSource",void 0),t([n("elevationSource",["attributes"])],y.prototype,"readElevationSource",null),t([o({json:{write:!0,name:"attributes.exposurestationid"}})],y.prototype,"exposureStationId",void 0),t([o({type:Number,json:{write:!0}})],y.prototype,"farDistance",void 0),t([n("farDistance",["attributes"])],y.prototype,"readFarDistance",null),t([o({type:c})],y.prototype,"geometry",void 0),t([o({type:Number,json:{write:!0}})],y.prototype,"horizontalFieldOfView",void 0),t([n("horizontalFieldOfView",["attributes"])],y.prototype,"readHFOV",null),t([o({json:{write:!0}})],y.prototype,"image",void 0),t([n("image",["attributes"])],y.prototype,"readImageURL",null),t([o({type:Number,json:{write:!0}})],y.prototype,"imageRotation",void 0),t([n("imageRotation",["attributes"])],y.prototype,"readImageRotation",null),t([o()],y.prototype,"isHorizontal",null),t([o()],y.prototype,"isInspection",null),t([o()],y.prototype,"isNadir",null),t([o()],y.prototype,"isOblique",null),t([o()],y.prototype,"isSpherical",null),t([o({json:{write:!0}})],y.prototype,"location",null),t([o({json:{write:!0}})],y.prototype,"name",void 0),t([n("name",["attributes"])],y.prototype,"readName",null),t([o({type:Number,json:{write:!0}})],y.prototype,"nearDistance",void 0),t([n("nearDistance",["attributes"])],y.prototype,"readNearDistance",null),t([o({json:{write:!0,name:"attributes.objectid"}})],y.prototype,"objectId",void 0),t([o({json:{write:!0}})],y.prototype,"orientationAccuracy",void 0),t([n("orientationAccuracy",["attributes"])],y.prototype,"readOrientationAccuracy",null),t([o({json:{write:!0}})],y.prototype,"orientedImageryType",void 0),t([n("orientedImageryType",["attributes"])],y.prototype,"readOIType",null),t([o({type:Number,json:{write:!0}})],y.prototype,"sortOrder",void 0),t([n("sortOrder",["attributes"])],y.prototype,"readSortOrder",null),t([o({type:Number,json:{write:!0}})],y.prototype,"verticalFieldOfView",void 0),t([n("verticalFieldOfView",["attributes"])],y.prototype,"readVFOV",null),y=t([s("esri.layers.orientedImagery.core.ExposurePoint")],y);const f=y;export{f as default};
