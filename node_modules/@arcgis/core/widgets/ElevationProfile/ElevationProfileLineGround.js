/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import o from"../../Color.js";import{handlesGroup as r}from"../../core/handleUtils.js";import{applySome as t}from"../../core/maybe.js";import{memoize as n}from"../../core/memoize.js";import{watch as i}from"../../core/reactiveUtils.js";import{getMetersPerVerticalUnitForSR as s}from"../../core/unitUtils.js";import{property as a}from"../../core/accessorSupport/decorators/property.js";import"../../core/accessorSupport/ensureType.js";import"../../core/arrayUtils.js";import"../../core/has.js";import{subclass as l}from"../../core/accessorSupport/decorators/subclass.js";import u from"./ElevationProfileLine.js";import{getGroundMinDemResolution as p}from"./support/elevationQuerySourceUtils.js";let c=class extends u{constructor(e){super(e),this.type="ground",this.color=new o("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=n(((e,o)=>({ground:e,groundLayers:o})))}get available(){const e=this._ground;return null!=e&&e.layers.some((e=>e.visible))}get minDemResolution(){return p(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){return t(this._viewModel?.view,(e=>e.map?.ground))}get _groundLayers(){const e=this._ground;return t(e,(e=>e.layers?.toArray()))??[]}async queryElevation(e,o){const r=this._queryElevationDependencies;if(null==r)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:t}=r;if(null==t)throw new Error("No ground configured in the view");const n=await t.queryElevation(e,o),i=s(e.spatialReference),a=s(t.layers.at(0).spatialReference);if(i!==a){const e=n.geometry;e.points=e.points.map((([e,r,t])=>[e,r,t===o.noDataValue?t:t*a/i]))}return n}attach(e){return r([super.attach(e),i((()=>this._queryElevationDependencies),(()=>this._onChange()))])}};e([a({type:o,nonNullable:!0})],c.prototype,"color",void 0),e([a()],c.prototype,"viewVisualizationEnabled",void 0),e([a()],c.prototype,"available",null),e([a({readOnly:!0})],c.prototype,"minDemResolution",null),e([a()],c.prototype,"_queryElevationDependencies",null),e([a()],c.prototype,"_ground",null),e([a()],c.prototype,"_groundLayers",null),c=e([l("esri.widgets.ElevationProfile.ElevationProfileLineGround")],c);const m=c;export{m as default};
