/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import s from"../core/Handles.js";import{watch as i}from"../core/reactiveUtils.js";import{property as e}from"../core/accessorSupport/decorators/property.js";import{cast as o}from"../core/accessorSupport/decorators/cast.js";import"../core/arrayUtils.js";import"../core/has.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";import l from"./Widget.js";import{loadCalciteComponents as a}from"./support/componentsUtils.js";import"./support/widgetUtils.js";import{messageBundle as c}from"./support/decorators/messageBundle.js";import{tsx as r}from"./support/jsxFactory.js";import d from"./UtilityNetworkAssociations/UtilityNetworkAssociationsViewModel.js";const h={widgetBlockContent:"esri-un-associations__widget-block-content",widgetBlockActions:"esri-un-associations__widget-block-actions",widgetBlockActionsSwitch:"esri-un-associations__widget-block-actions-switch",widgetSettingsContainer:"esri-un-associations__widget-settings-container",widgetControlsLabelAndToggle:"esri-un-associations__controls-label-and-toggle",widgetControlsLabelAndSlider:"esri-un-associations__controls-label-and-slider",widgetControlsLabel:"esri-un-associations__controls-label",widgetControlsSlider:"esri-un-associations__controls-slider"},A={maxAllowableAssociationsSlider:!1};let w=class extends l{constructor(t,i){super(t,i),this._autoRefreshAssociations=!0,this._associationsOptionsEnabled=!1,this._handles=new s,this._maxAllowableAssociationsSliderMax=1e3,this._maxAllowableAssociationsSliderMin=250,this._maxAllowableAssociationsSliderStep=250,this.messages=null,this.showAssociationsEnabled=!1,this.viewModel=new d,this.visibleElements={...A}}initialize(){this._handles.add([i((()=>[this.view?.stationary,this.showAssociationsEnabled,this.includeConnectivityAssociations,this.includeStructuralAttachmentAssociations,this.maxAllowableAssociations]),(()=>{!0===this.autoRefreshAssociations&&(!0===this.showAssociationsEnabled?this.viewModel.showAssociations():this.viewModel.removeAssociations())}))])}get autoRefreshAssociations(){return this._autoRefreshAssociations}set autoRefreshAssociations(t){this._autoRefreshAssociations=t}get connectivityAssociationsLineSymbol(){return this.viewModel.connectivityAssociationsLineSymbol}set connectivityAssociationsLineSymbol(t){this.viewModel.connectivityAssociationsLineSymbol=t}get includeConnectivityAssociations(){return this.viewModel.includeConnectivityAssociations}set includeConnectivityAssociations(t){this.viewModel.includeConnectivityAssociations=t}get includeStructuralAttachmentAssociations(){return this.viewModel.includeStructuralAttachmentAssociations}set includeStructuralAttachmentAssociations(t){this.viewModel.includeStructuralAttachmentAssociations=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get maxAllowableAssociations(){return this.viewModel.maxAllowableAssociations}set maxAllowableAssociations(t){this.viewModel.maxAllowableAssociations=t}get maxAllowableAssociationsSliderMax(){return this._maxAllowableAssociationsSliderMax}set maxAllowableAssociationsSliderMax(t){t<=this.maxAllowableAssociationsSliderMin||(this._maxAllowableAssociationsSliderMax=t)}get maxAllowableAssociationsSliderMin(){return this._maxAllowableAssociationsSliderMin}set maxAllowableAssociationsSliderMin(t){t<0||t>=this.maxAllowableAssociationsSliderMax||(this._maxAllowableAssociationsSliderMin=t)}get maxAllowableAssociationsSliderStep(){return this._maxAllowableAssociationsSliderStep}set maxAllowableAssociationsSliderStep(t){this._maxAllowableAssociationsSliderStep=t}get showArrowsConnectivity(){return this.viewModel.showArrowsConnectivity}set showArrowsConnectivity(t){this.viewModel.showArrowsConnectivity=t}get showArrowsStructuralAttachment(){return this.viewModel.showArrowsStructuralAttachment}set showArrowsStructuralAttachment(t){this.viewModel.showArrowsStructuralAttachment=t}get structuralAttachmentAssociationsLineSymbol(){return this.viewModel.structuralAttachmentAssociationsLineSymbol}set structuralAttachmentAssociationsLineSymbol(t){this.viewModel.structuralAttachmentAssociationsLineSymbol=t}get utilityNetwork(){return this.viewModel.utilityNetwork}set utilityNetwork(t){this.viewModel.utilityNetwork=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...A,...t}}render(){const t=this.viewModel;return r("div",null,r("calcite-block",{heading:this.label,class:h.widgetBlockContent,collapsible:"disabled"!==t.state,open:"disabled"===t.state},this.renderShowStatusIcon(),this.autoRefreshAssociations?this.renderShowAssociationsSwitch():this.renderRefreshAssociationsAction(),this.renderSettings()),this.autoRefreshAssociations?this.renderShowAssociationsSwitchTooltip():this.renderRefreshAssociationsActionTooltip(),this.renderShowStatusIconTooltip())}loadDependencies(){return a({action:()=>import("@esri/calcite-components/dist/components/calcite-action.js"),block:()=>import("@esri/calcite-components/dist/components/calcite-block.js"),label:()=>import("@esri/calcite-components/dist/components/calcite-label.js"),notice:()=>import("@esri/calcite-components/dist/components/calcite-notice.js"),slider:()=>import("@esri/calcite-components/dist/components/calcite-slider.js"),switch:()=>import("@esri/calcite-components/dist/components/calcite-switch.js"),tooltip:()=>import("@esri/calcite-components/dist/components/calcite-tooltip.js")})}renderConnectivityAssociationsToggle(){const{messages:t}=this;return r("div",{class:h.widgetControlsLabelAndToggle},r("calcite-label",{class:h.widgetControlsLabel},t.inputStrings.enableConnectivity),r("calcite-switch",{bind:this,disabled:!this._associationsOptionsEnabled&&this.autoRefreshAssociations,checked:this.includeConnectivityAssociations,onCalciteSwitchChange:this._connectivityAssociationsSwitchChange}))}renderMaxAllowableAssociationsSlider(){const{messages:t,visibleElements:{maxAllowableAssociationsSlider:s}}=this;if(s)return r("div",{class:h.widgetControlsLabelAndSlider},r("calcite-label",{class:h.widgetControlsLabel},t.inputStrings.maxAllowableAssociations),r("calcite-slider",{bind:this,class:h.widgetControlsSlider,disabled:!this._associationsOptionsEnabled&&this.autoRefreshAssociations,min:this.maxAllowableAssociationsSliderMin,max:this.maxAllowableAssociationsSliderMax,step:this.maxAllowableAssociationsSliderStep,ticks:this.maxAllowableAssociationsSliderStep,value:this.maxAllowableAssociations,labelTicks:!0,snap:!0,scale:"s",onCalciteSliderChange:this._maxAllowableAssociationsSliderChange}))}renderRefreshAssociationsAction(){if("disabled"!==this.viewModel.state)return r("div",{slot:"control",style:"--calcite-ui-icon-color: #077ac2"},r("calcite-action",{id:"refreshAssociations-action",bind:this,class:h.widgetBlockActions,icon:"refresh-",text:"",onclick:this._refreshAssociations}))}renderRefreshAssociationsActionTooltip(){const{messages:t}=this;return r("calcite-tooltip",{label:"refreshAssociations-action-tooltip-label",referenceElement:"refreshAssociations-action"},r("span",null,t.inputStrings.refreshAssociations))}renderSettings(){const t=this.viewModel;return"disabled"===t.state?r("calcite-notice",{open:!0,kind:"warning",scale:"s"},r("div",{slot:"message"},t.errorMessage)):r("div",{class:h.widgetSettingsContainer},this.renderConnectivityAssociationsToggle(),this.renderStructuralAttachmentAssociationsToggle(),this.renderMaxAllowableAssociationsSlider())}renderShowAssociationsSwitch(){return"disabled"===this.viewModel.state?r("div",{id:"showAssociations-switch"}):r("calcite-switch",{id:"showAssociations-switch",bind:this,class:h.widgetBlockActionsSwitch,checked:this.showAssociationsEnabled,onCalciteSwitchChange:this._showAssociationsSwitchChange,slot:"control"})}renderShowAssociationsSwitchTooltip(){const{messages:t}=this;return r("calcite-tooltip",{label:"showAssociations-switch-tooltip-label",referenceElement:"showAssociations-switch"},r("span",null,t.inputStrings.enableAssociations))}renderShowStatusIcon(){const t=this.viewModel,s=()=>{switch(t.state){case"disabled":case"failed":case"warning":return"exclamation-mark-triangle";default:return"blank"}},i=()=>{switch(t.state){case"disabled":case"failed":case"warning":return!1;default:return!0}};return r("div",{slot:"control",style:"--calcite-ui-icon-color: #edd317"},r("calcite-action",{id:"statusIcon-action",class:h.widgetBlockActions,icon:s(),disabled:i(),text:"",slot:"control"}))}renderShowStatusIconTooltip(){const t=this.viewModel,s=()=>{switch(t.state){case"failed":case"warning":return t.errorMessage;default:return""}};if("disabled"!==t.state)return r("calcite-tooltip",{label:"statusIcon-status-tooltip-label",referenceElement:"statusIcon-action"},r("span",null,s()))}renderStructuralAttachmentAssociationsToggle(){const{messages:t}=this;return r("div",{class:h.widgetControlsLabelAndToggle},r("calcite-label",{class:h.widgetControlsLabel},t.inputStrings.enableStructuralAttachment),r("calcite-switch",{bind:this,disabled:!this._associationsOptionsEnabled&&this.autoRefreshAssociations,checked:this.includeStructuralAttachmentAssociations,onCalciteSwitchChange:this._structuralAttAssociationsSwitchChange}))}_connectivityAssociationsSwitchChange(t){this.includeConnectivityAssociations=t.target.checked}_maxAllowableAssociationsSliderChange(t){this.maxAllowableAssociations=Number(t.target.value)}_refreshAssociations(){this.viewModel.showAssociations()}_showAssociationsSwitchChange(t){this.showAssociationsEnabled=t.target.checked,this._associationsOptionsEnabled=t.target.checked}_structuralAttAssociationsSwitchChange(t){this.includeStructuralAttachmentAssociations=t.target.checked}};t([e()],w.prototype,"connectivityAssociationsLineSymbol",null),t([e()],w.prototype,"includeConnectivityAssociations",null),t([e()],w.prototype,"includeStructuralAttachmentAssociations",null),t([e()],w.prototype,"label",null),t([e()],w.prototype,"maxAllowableAssociations",null),t([e()],w.prototype,"maxAllowableAssociationsSliderMax",null),t([e()],w.prototype,"maxAllowableAssociationsSliderMin",null),t([e()],w.prototype,"maxAllowableAssociationsSliderStep",null),t([e(),c("esri/widgets/UtilityNetworkAssociations/t9n/UtilityNetworkAssociations")],w.prototype,"messages",void 0),t([e()],w.prototype,"showArrowsConnectivity",null),t([e()],w.prototype,"showArrowsStructuralAttachment",null),t([e()],w.prototype,"showAssociationsEnabled",void 0),t([e()],w.prototype,"structuralAttachmentAssociationsLineSymbol",null),t([e()],w.prototype,"utilityNetwork",null),t([e()],w.prototype,"view",null),t([e({type:d})],w.prototype,"viewModel",void 0),t([e()],w.prototype,"visibleElements",void 0),t([o("visibleElements")],w.prototype,"castVisibleElements",null),w=t([n("esri.widgets.UtilityNetworkAssociations")],w);const u=w;export{u as default};
