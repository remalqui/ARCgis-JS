/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{handlesGroup as e,makeHandle as o}from"../../core/handleUtils.js";import{destroyMaybe as r}from"../../core/maybe.js";import{throwIfAborted as t}from"../../core/promiseUtils.js";import{watch as a}from"../../core/reactiveUtils.js";import{showProgressCursor as s}from"./workflowUtils.js";async function c({view:c,data:l,signal:i,next:m,cancel:u}){const{creationInfo:p}=l;if(!p)return;if(!n(p))return;const{layer:f}=p,d=null!=p.geometryToPlace;if(p.geometryToPlace=null,d)return void u();const y=(await import("./Upload.js")).Upload;t(i);const j=new y;l.upload=j;const w=s(c),U=e([w,a((()=>j.state),(e=>{switch(e){case"success":p.maxFeatures=1,p.geometryToPlace=j.result,m();break;case"error":w.remove();break;case"canceled":u()}})),o((()=>{l.upload=r(l.upload)}))]);return j.uploadTo(f),U}function n(e){const o=e?.layer;return"scene"===o?.type}export{n as isModelUpload,c as waitForModelUpload};
