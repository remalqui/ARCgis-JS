/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{makeHandle as e}from"../../core/handleUtils.js";import{WIDGET_SYMBOL as t}from"./symbols.js";const r=[],o={},n=new WeakMap;function i(e,t){let n=t.children;if(n&&n.length)for(let r=0;r<n.length;++r)n[r]=i(e,n[r]);else n=r;const f=t.vnodeSelector;if(a(f)){const r=t.properties||o,i=r.key||f;return{vnodeSelector:"div",properties:{key:i,afterCreate:d,afterUpdate:s,afterRemoved:c,parentWidget:e,widgetConstructor:f,widgetProperties:{...r,key:i,children:n}},children:void 0,text:void 0,domNode:null}}return t}function d(t,r,o,{parentWidget:i,widgetConstructor:d,widgetProperties:s}){const a=new d(s);a.container=t,n.set(t,a),a.afterCreate?.(a,t),i._internalHandles.add(e((()=>c(t))))}function s(e,t,r,{widgetProperties:o}){const i=n.get(e);i&&(i.set(o),i.afterUpdate?.(i,e))}function c(e){const t=n.get(e);t&&(t.afterRemoved?.(t,e),t.destroy(),n.delete(e))}function a(e){return"function"==typeof e&&e[t]}export{a as isWidgetConstructor,i as processWidgets};
