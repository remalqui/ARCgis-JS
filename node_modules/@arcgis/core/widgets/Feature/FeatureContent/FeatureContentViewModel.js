/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as t}from"../../../chunks/tslib.es6.js";import r from"../../../Graphic.js";import e from"../../../core/Accessor.js";import{HandleOwnerMixin as o}from"../../../core/HandleOwner.js";import{watch as s,initial as i}from"../../../core/reactiveUtils.js";import{property as a}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/accessorSupport/ensureType.js";import"../../../core/arrayUtils.js";import"../../../core/has.js";import{subclass as c}from"../../../core/accessorSupport/decorators/subclass.js";import{graphicCallback as n}from"../support/featureUtils.js";let p=class extends(o(e)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(s((()=>this.creator),(t=>{this._destroyContent(),this._createContent(t)}),i))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:r,destroyer:e}=this;t&&r&&(n(e,{graphic:r}).catch((()=>null)),this._set("created",null))}async _createContent(t){const r=this.graphic;if(!r||!t)return;const e=n(t,{graphic:r}).catch((()=>null));this._loadingPromise=e,this.notifyChange("state");const o=await e;e===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o))}};t([a({readOnly:!0})],p.prototype,"created",void 0),t([a()],p.prototype,"creator",void 0),t([a()],p.prototype,"destroyer",void 0),t([a({type:r})],p.prototype,"graphic",void 0),t([a({readOnly:!0})],p.prototype,"state",null),p=t([c("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],p);const l=p;export{l as default};
