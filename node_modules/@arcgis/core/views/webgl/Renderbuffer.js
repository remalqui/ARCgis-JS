/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{nullifyNonNullableForDispose as e}from"../../core/maybe.js";import{ContextType as t}from"./contextUtils.js";import{ResourceType as r}from"./enums.js";import{GLObjectType as s}from"./GLObjectType.js";import{estimateMemory as i}from"./RenderbufferDescriptor.js";class n{constructor(e,i){this._context=e,this._descriptor=i,this.type=s.RenderBuffer,this._context.instanceCounter.increment(r.Renderbuffer,this);const n=this._context.gl;this.glName=n.createRenderbuffer(),this._context.bindRenderbuffer(this);const{width:o,height:h,internalFormat:c,multisampled:f}=i;if(f){if(this._context.type!==t.WEBGL2)throw new Error("Multisampled renderbuffers are not supported in WebGL1!");n.renderbufferStorageMultisample(n.RENDERBUFFER,this.samples,c,o,h)}else n.renderbufferStorage(n.RENDERBUFFER,c,o,h)}get descriptor(){return this._descriptor}get samples(){const e=this._descriptor.samples,t=this._context.parameters.maxSamples;return e?Math.min(e,t):t}get gpuMemoryUsage(){return i(this._descriptor)}resize(e,t){const r=this._descriptor;if(r.width===e&&r.height===t)return;r.width=e,r.height=t;const s=this._context.gl;if(this._context.bindRenderbuffer(this),r.multisampled){s.renderbufferStorageMultisample(s.RENDERBUFFER,this.samples,r.internalFormat,r.width,r.height)}else s.renderbufferStorage(s.RENDERBUFFER,r.internalFormat,r.width,r.height)}dispose(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(r.Renderbuffer,this),this._context=e(this._context))}}export{n as Renderbuffer};
