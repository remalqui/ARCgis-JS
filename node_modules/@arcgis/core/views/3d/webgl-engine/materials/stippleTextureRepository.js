/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{packFloatRGBA as t}from"../../../../core/floatRGBA.js";import{ProceduralTextureRepository as e}from"./ProceduralTextureRepository.js";import{PixelFormat as r,TextureWrapMode as o}from"../../../webgl/enums.js";import{Texture as n}from"../../../webgl/Texture.js";import{TextureDescriptor as i}from"../../../webgl/TextureDescriptor.js";function a(t,a){return new e((e=>{const{encodedData:a,paddedPixels:u}=c(e),s=new i;return s.internalFormat=r.RGBA,s.width=u,s.height=1,s.wrapMode=o.CLAMP_TO_EDGE,new n(t,s,a)}),(t=>`${t.pattern.join(",")}-r${t.pixelRatio}`),a)}function c(e){const r=u(e),o=1/e.pixelRatio,n=s(e),i=l(e),a=(Math.floor(.5*(i-1))+.5)*o,c=[];let f=1;for(const t of r){for(let e=0;e<t;e++){const r=f*(Math.min(e,t-1-e)+.5)*o/a*.5+.5;c.push(r)}f=-f}const d=Math.round(r[0]/2),m=[...c.slice(d),...c.slice(0,d)],h=n+p,x=new Uint8Array(4*h);let w=4;for(const u of m)t(u,x,w),w+=4;return x.copyWithin(0,w-4,w),x.copyWithin(w,4,8),{encodedData:x,paddedPixels:h}}function u(t){return t.pattern.map((e=>Math.round(e*t.pixelRatio)))}function s(t){if(null==t)return 1;const e=u(t);return Math.floor(e.reduce(((t,e)=>t+e)))}function l(t){return u(t).reduce(((t,e)=>Math.max(t,e)))}const p=2;export{p as STIPPLE_TEXTURE_PADDING,l as computeLongestPattern,s as computeTextureSize,a as createStippleTextureRepository};
