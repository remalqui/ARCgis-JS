/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{s as t}from"../../../../chunks/vec2.js";import{e as r,c as e,s,a as o,l as i,n as f,f as m}from"../../../../chunks/vec3.js";import{c as p}from"../../../../chunks/vec3f64.js";import{create as a,fromPositionAndNormal as u,intersectRay as c}from"../../../../geometry/support/plane.js";import{wrap as n}from"../../../../geometry/support/ray.js";import{makeOrthoBasisDirUpFallback as h}from"./GeometryUtil.js";function g(t,r,e){t[0]=e[0]*r.right[0]+e[1]*r.up[0],t[1]=e[0]*r.right[1]+e[1]*r.up[1],t[2]=e[0]*r.right[2]+e[1]*r.up[2]}function v(e,s,o){t(e,r(o,s.right),r(o,s.up))}function l(t,r){let g=null;const v=t.vertices.length,l=.99619469809,R=p(),y=p(),k=p(),L=p(),q=p(),x=p(),G=a();let M=t.vertices[0];e(y,r),s(R,0,1,0),h(M.vRight,y,R,R,k,y,l),e(M.frame.up,y),e(M.frame.right,k);const U=t.positions;let b=t.offset;g=M;for(let p=1;p<v;++p){M=t.vertices[p],o(q,M.vLeft,M.vRight);let r=i(q);r>0?(r=1/Math.sqrt(r),q[0]=q[0]*r,q[1]=q[1]*r,q[2]=q[2]*r):(q[0]=M.vRight[0],q[1]=M.vRight[1],q[2]=M.vRight[2]),x[0]=U[b]+g.frame.up[0],x[1]=U[b+1]+g.frame.up[1],x[2]=U[b+2]+g.frame.up[2],b+=3;const a=s(j,U[b],U[b+1],U[b+2]);u(a,q,G);c(G,n(x,M.vLeft),L)?(L[0]-=U[b],L[1]-=U[b+1],L[2]-=U[b+2],f(y,L),m(k,q,y),f(k,k)):h(q,g.frame.up,g.frame.right,R,k,y,l),e(M.frame.up,y),e(M.frame.right,k),g=M}}const j=p();export{l as computeMinimumRotationTangentFrame,g as profileSpaceToVertexSpace,v as vertexSpaceToProfileSpace};
