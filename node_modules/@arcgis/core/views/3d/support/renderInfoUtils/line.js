/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{projectBuffer as o}from"../../../../geometry/projection.js";import{newDoubleArray as t,doubleSubArray as n}from"../../../../geometry/support/DoubleArray.js";import{CounterClockwiseMode as e,pathsToTriangulationInfo as r}from"../../../../geometry/support/triangulationUtils.js";import{applyPerVertexElevationAlignment as i}from"../../layers/graphics/elevationAlignmentUtils.js";import{DRAPED_Z as s}from"../../terrain/OverlayRenderer.js";function p(o,n,s,p){const l="polygon"===o.type?e.CCW_IS_HOLE:e.NONE,u="polygon"===o.type?o.rings:o.paths,{position:a,outlines:g}=r(u,!!o.hasZ,l),m=t(a.length),y=i(a,o.spatialReference,0,m,0,a,0,a.length/3,n,s,p),f=null!=y;return{lines:f?c(g,a,m):[],projectionSuccess:f,sampledElevation:y}}function l(t,n){const i="polygon"===t.type?e.CCW_IS_HOLE:e.NONE,p="polygon"===t.type?t.rings:t.paths,{position:l,outlines:u}=r(p,!1,i),a=o(l,t.spatialReference,0,l,n,0,l.length/3);for(let o=2;o<l.length;o+=3)l[o]=s;return{lines:a?c(u,l):[],projectionSuccess:a}}function c(o,t,e=null){const r=new Array;for(const{index:i,count:s}of o){if(s<=1)continue;const o=3*i,p=3*s;r.push({position:n(t,3*i,3*s),mapPositions:null!=e?n(e,o,p):void 0})}return r}export{p as geometryToRenderInfo,l as geometryToRenderInfoDraped};
