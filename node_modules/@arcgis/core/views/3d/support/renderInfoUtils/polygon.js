/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{projectBuffer as o}from"../../../../geometry/projection.js";import{newDoubleArray as t,doubleSubArray as n}from"../../../../geometry/support/DoubleArray.js";import{pathsToTriangulationInfo as s,CounterClockwiseMode as i}from"../../../../geometry/support/triangulationUtils.js";import{applyPerVertexElevationAlignment as e}from"../../layers/graphics/elevationAlignmentUtils.js";import{DRAPED_Z as r}from"../../terrain/OverlayRenderer.js";function p(o,n,r,p){const l=s(o.rings,!!o.hasZ,i.CCW_IS_HOLE),h=t(l.position.length),a=e(l.position,o.spatialReference,0,h,0,l.position,0,l.position.length/3,n,r,p),g=null!=a;return new f(l.position,h,u(l.polygons,l.position,h),c(l.outlines,l.position,h),g,a)}function l(t,n){const e=s(t.rings,!1,i.CCW_IS_HOLE),p=o(e.position,t.spatialReference,0,e.position,n,0,e.position.length/3);for(let o=2;o<e.position.length;o+=3)e.position[o]=r;return{position:e.position,polygons:u(e.polygons,e.position),outlines:c(e.outlines,e.position),projectionSuccess:p}}function c(o,t,s=null){return o.filter((({count:o})=>o>1)).map((({index:o,count:i})=>{const e=3*o,r=3*i;return null!=s?new a(o,i,n(t,e,r),n(s,e,r)):new h(o,i,n(t,e,r))}))}function u(o,t,s=null){const i=new Array;for(const{index:e,count:r,holeIndices:p,pathLengths:l}of o){if(r<=1)continue;const o=3*e,c=3*r,u=p.map((o=>o-e)),h=null!=s?new g(e,r,n(t,3*e,3*r),n(s,o,c),u,l):new m(e,r,n(t,3*e,3*r),u,l);i.push(h)}return i}class h{constructor(o,t,n){this.index=o,this.count=t,this.position=n}}class a extends h{constructor(o,t,n,s){super(o,t,n),this.mapPositions=s}}class g extends a{constructor(o,t,n,s,i,e){super(o,t,n,s),this.holeIndices=i,this.pathLengths=e}}class m extends h{constructor(o,t,n,s,i){super(o,t,n),this.holeIndices=s,this.pathLengths=i}}class f{constructor(o,t,n,s,i,e){this.position=o,this.mapPositions=t,this.polygons=n,this.outlines=s,this.projectionSuccess=i,this.sampledElevation=e}}export{f as PolygonRenderInfo,g as PolygonVertexData,m as PolygonVertexDataDraped,p as geometryToRenderInfo,l as geometryToRenderInfoDraped};
