/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import"../core/has.js";import t from"../core/Logger.js";import{acosClamped as n,cartesianToSpherical as r}from"../core/mathUtils.js";import{d as e}from"./mat4.js";import{c as o,a as s,g as i,i as a,l as c,f as u,m as f,b as m,p,n as g,s as l,d as h,h as d}from"./vec3.js";import{c as j}from"./vec3f64.js";import{c as y}from"./vec4.js";import{c as M,f as v}from"./vec4f64.js";import{Axis as S}from"../geometry/support/Axis.js";import{closestPoint as b}from"../geometry/support/ray.js";import{angle as x}from"../geometry/support/vector.js";import{sv3d as A,sm4d as P}from"../geometry/support/vectorStacks.js";const R=_();function _(){return M()}function q(t,n=_()){return y(n,t)}function w(t,n){return v(t[0],t[1],t[2],n)}function C(t){return t}function O(t){t[0]=t[1]=t[2]=t[3]=0}function T(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function k(t){return t[3]}function z(t){return t}function E(t,n,r,e){return v(t,n,r,e)}function L(t,n,r){return t!==r&&o(r,t),r[3]=t[3]+n,r}function N(n,r,e){return t.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),n===e?e:q(n,e)}function Z(t,n,r){if(null==n)return!1;const{origin:e,direction:o}=n,s=U;s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2];const i=o[0]*o[0]+o[1]*o[1]+o[2]*o[2];if(0===i)return!1;const a=2*(o[0]*s[0]+o[1]*s[1]+o[2]*s[2]),c=a*a-4*i*(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);let f=(-a-u)/(2*i);const m=(-a+u)/(2*i);return(f<0||m<f&&m>0)&&(f=m),!(f<0)&&(r&&(r[0]=e[0]+o[0]*f,r[1]=e[1]+o[1]*f,r[2]=e[2]+o[2]*f),!0)}const U=j();function V(t,n){return Z(t,n,null)}function X(t,n,r){if(Z(t,n,r))return r;const e=Y(t,n,A.get());return s(r,n.origin,i(A.get(),n.direction,a(n.origin,e)/c(n.direction))),r}function Y(t,n,r){const o=A.get(),s=P.get();u(o,n.origin,n.direction);const a=k(t);u(r,o,n.origin),i(r,r,1/c(r)*a);const m=G(t,n.origin),p=x(n.origin,r);return e(s,p+m,o),f(r,r,s),r}function B(t,n,r){return Z(t,n,r)?r:(b(n,z(t),r),D(t,r,r))}function D(t,n,r){const e=m(A.get(),n,z(t)),o=i(A.get(),e,t[3]/c(e));return s(r,o,z(t))}function F(t,n){const r=m(A.get(),n,z(t)),e=p(r),o=t[3]*t[3];return Math.sqrt(Math.abs(e-o))}function G(t,r){const e=m(A.get(),r,z(t)),o=c(e),s=k(t),i=s+Math.abs(s-o);return n(s/i)}const H=j();function I(t,n,e,o){const s=m(H,n,z(t));switch(e){case S.X:{const t=r(s,H)[2];return l(o,-Math.sin(t),Math.cos(t),0)}case S.Y:{const t=r(s,H),n=t[1],e=t[2],i=Math.sin(n);return l(o,-i*Math.cos(e),-i*Math.sin(e),Math.cos(n))}case S.Z:return g(o,s);default:return}}function J(t,n){const r=m($,n,z(t));return c(r)-t[3]}function K(t,n,r,e){const o=J(t,n),a=I(t,n,S.Z,$),c=i($,a,r-o);return s(e,n,c)}function Q(t,n){const r=h(z(t),n),e=k(t);return r<=e*e}function W(t,n,r=_()){const e=a(t,n),o=t[3],s=n[3];return e+s<o?(y(r,t),r):e+o<s?(y(r,n),r):(d(r,t,n,(e+s-o)/(2*e)),r[3]=(e+o+s)/2,r)}const $=j(),tt=_(),nt=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:R,altitudeAt:J,angleToSilhouette:G,axisAt:I,clear:O,closestPoint:B,closestPointOnSilhouette:Y,containsPoint:Q,copy:q,create:_,distanceToSilhouette:F,elevate:L,fromCenterAndRadius:w,fromRadius:T,fromValues:E,getCenter:z,getRadius:k,intersectRay:Z,intersectRayClosestSilhouette:X,intersectsRay:V,projectPoint:D,setAltitudeAt:K,setExtent:N,tmpSphere:tt,union:W,wrap:C},Symbol.toStringTag,{value:"Module"}));export{R as N,k as a,Y as b,_ as c,F as d,T as e,E as f,z as g,q as h,Z as i,V as j,w as k,Q as l,O as m,L as n,N as o,X as p,B as q,D as r,nt as s,tt as t,W as u,G as v,C as w,I as x,J as y,K as z};
