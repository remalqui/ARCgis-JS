/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{s as e,p as r,q as t,b as s}from"./vec2.js";import{a as o}from"./vec2f64.js";import{Float2PassUniform as i}from"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js";import{NoParameters as a,glsl as n}from"../views/3d/webgl-engine/core/shaderModules/interfaces.js";import{ShaderBuilder as d}from"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js";import{Texture2DPassUniform as c}from"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js";import{VertexAttribute as u}from"../views/3d/webgl-engine/lib/VertexAttribute.js";class l extends a{constructor(){super(...arguments),this.scale=o()}}function m(e){const r=new d;r.attributes.add(u.POSITION,"vec2"),r.varyings.add("uv0","vec2"),r.varyings.add("uv1","vec2"),r.vertex.uniforms.add(new i("scale",(e=>e.scale))),r.vertex.code.add(n`void main(void) {
gl_Position = vec4(position, 0.0, 1.0);
uv0 = position * 0.5 + vec2(0.5);
uv1 = (position * 0.5 + vec2(0.5)) * scale;
}`),r.fragment.uniforms.add(new c("tex",(e=>e.texture)),new c("depthTexture",(e=>e.depthTexture)),new i("scale",(e=>e.scale)),new i("clampUV",(e=>v(e))));const t=e.haze;return r.fragment.code.add(n`
    void main() {
      ${t?n`vec4`:n`float`} depthSample = texture(depthTexture, uv0) ${t?"":n`.r`};
      if (depthSample ${t?n`== vec4(0)`:n`!= 1.0`} ) {
          fragColor = vec4(0);
          return;
      }
      fragColor = texture(tex, min(uv1, clampUV));
    }
    `),r}function v(o){if(!o.texture)return p;const i=e(p,o.texture.descriptor.width,o.texture.descriptor.height),a=r(i,i,o.scale),n=t(a,a);return s(n,o.scale,n)}const p=o(),f=Object.freeze(Object.defineProperty({__proto__:null,AtmosphereCompositingPassParameters:l,build:m},Symbol.toStringTag,{value:"Module"}));export{l as A,f as a,m as b};
