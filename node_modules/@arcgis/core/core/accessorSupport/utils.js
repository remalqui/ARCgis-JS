/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{handlesGroup as r}from"../handleUtils.js";import{clone as n}from"../lang.js";import{assumeNonNull as t}from"../maybe.js";function e(r){return r.__accessor__??null}function i(r,n){return null!=r&&r.metadatas&&null!=r.metadatas[n]}function u(r,n){const t=e(r);return t?t.getDependsInfo(r,n,""):""}function o(r,n,t){if(t){return a(r,n,{policy:t,path:""})}return a(r,n,null)}function a(r,e,i){return e?Object.keys(e).reduce(((r,u)=>{const o=u;let l=null,s="merge";if(i&&(l=i.path?`${i.path}.${u}`:u,s=i.policy(l)),"replace"===s)return r[o]=e[o],r;if("replace-arrays"===s&&Array.isArray(r[o]))return r[o]=e[o],r;if(void 0===r[o])return r[o]=n(e[o]),r;let c=r[o],f=e[o];if(c===f)return r;if(Array.isArray(f)||Array.isArray(r))c=c?Array.isArray(c)?r[o]=c.concat():r[o]=[c]:r[o]=[],f&&(Array.isArray(f)||(f=[f]),f.forEach((r=>{c.includes(r)||c.push(r)})));else if(f&&"object"==typeof f)if(i){const n=i.path;i.path=t(l),r[o]=a(c,f,i),i.path=n}else r[o]=a(c,f,null);else r.hasOwnProperty(u)&&!e.hasOwnProperty(u)||(r[o]=f);return r}),r||{}):r}function l(r){return r&&("string"!=typeof r||r.includes("."))?s(r):r}function s(r){return Array.isArray(r)?r:r.split(".")}function c(r){return r.includes(",")?r.split(",").map((r=>r.trim())):[r.trim()]}function f(r){if(Array.isArray(r)){const n=[];for(const t of r)n.push(...c(t));return n}return c(r)}function p(r){if(!r.includes("?"))return null;const n=s(r),t=new Array(n.length);for(let e=0;e<n.length;e++){const r=n[e];t[e]="?"===r[r.length-1],t[e]&&(n[e]=r.slice(0,-1))}return{fullPath:n.join("."),conditional:t}}function y(n,t,e,i){const u=f(t);if(1!==u.length){const t=u.map((r=>i(n,r,e)));return r(t)}return i(n,u[0],e)}function h(r){let n=!1;return()=>{n||(n=!0,r())}}export{u as getDependsInfo,e as getProperties,i as isPropertyDeclared,o as merge,h as once,y as parse,p as parseConditionalPath,s as pathToArray,l as pathToStringOrArray,f as splitPath};
